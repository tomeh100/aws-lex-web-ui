/*!
* lex-web-ui v"0.14.0"
* (c) 2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.
* Released under the Amazon Software License.
*/   
!(function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("vue"),require("vuex"),require("aws-sdk/global"),require("aws-sdk/clients/lexruntime"),require("aws-sdk/clients/polly")):"function"==typeof define&&define.amd?define(["vue","vuex","aws-sdk/global","aws-sdk/clients/lexruntime","aws-sdk/clients/polly"],t):"object"==typeof exports?exports.LexWebUi=t(require("vue"),require("vuex"),require("aws-sdk/global"),require("aws-sdk/clients/lexruntime"),require("aws-sdk/clients/polly")):e.LexWebUi=t(e.vue,e.vuex,e["aws-sdk/global"],e["aws-sdk/clients/lexruntime"],e["aws-sdk/clients/polly"])})("undefined"!=typeof self?self:this,(function(e,t,n,r,i){return (function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=65)})([(function(e,t){var n=e.exports={version:"2.5.3"};"number"==typeof __e&&(__e=n)}),(function(e,t,n){var r=n(34)("wks"),i=n(22),o=n(2).Symbol,s="function"==typeof o;(e.exports=function(e){return r[e]||(r[e]=s&&o[e]||(s?o:i)("Symbol."+e))}).store=r}),(function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)}),(function(e,t,n){var r=n(2),i=n(0),o=n(16),s=n(8),a=function(e,t,n){var u,c,l,f=e&a.F,d=e&a.G,p=e&a.S,h=e&a.P,g=e&a.B,v=e&a.W,m=d?i:i[t]||(i[t]={}),b=m.prototype,y=d?r:p?r[t]:(r[t]||{}).prototype;d&&(n=t);for(u in n)(c=!f&&y&&void 0!==y[u])&&u in m||(l=c?y[u]:n[u],m[u]=d&&"function"!=typeof y[u]?n[u]:g&&c?o(l,r):v&&y[u]==l?(function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t.prototype=e.prototype,t})(l):h&&"function"==typeof l?o(Function.call,l):l,h&&((m.virtual||(m.virtual={}))[u]=l,e&a.R&&b&&!b[u]&&s(b,u,l)))};a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,a.U=64,a.R=128,e.exports=a}),(function(e,t,n){var r=n(5),i=n(46),o=n(29),s=Object.defineProperty;t.f=n(7)?Object.defineProperty:function(e,t,n){if(r(e),t=o(t,!0),r(n),i)try{return s(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}}),(function(e,t,n){var r=n(9);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}}),(function(e,t){e.exports=function(e,t,n,r,i,o){var s,a=e=e||{},u=typeof e.default;"object"!==u&&"function"!==u||(s=e,a=e.default);var c="function"==typeof a?a.options:a;t&&(c.render=t.render,c.staticRenderFns=t.staticRenderFns,c._compiled=!0),n&&(c.functional=!0),i&&(c._scopeId=i);var l;if(o?(l=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),r&&r.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(o)},c._ssrRegister=l):r&&(l=r),l){var f=c.functional,d=f?c.render:c.beforeCreate;f?(c._injectStyles=l,c.render=function(e,t){return l.call(t),d(e,t)}):c.beforeCreate=d?[].concat(d,l):[l]}return{esModule:s,exports:a,options:c}}}),(function(e,t,n){e.exports=!n(11)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))}),(function(e,t,n){var r=n(4),i=n(17);e.exports=n(7)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}}),(function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}}),(function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}}),(function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}}),(function(e,t,n){var r=n(48),i=n(30);e.exports=function(e){return r(i(e))}}),(function(e,t,n){e.exports={default:n(73),__esModule:!0}}),(function(e,t){e.exports={}}),(function(e,t,n){"use strict";t.__esModule=!0;var r=n(45),i=(function(e){return e&&e.__esModule?e:{default:e}})(r);t.default=i.default||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}}),(function(e,t,n){var r=n(21);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}}),(function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}}),(function(e,t,n){var r=n(47),i=n(35);e.exports=Object.keys||function(e){return r(e,i)}}),(function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}}),(function(e,t,n){"use strict";var r=n(74)(!0);n(50)(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})}))}),(function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}}),(function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}}),(function(e,t){t.f={}.propertyIsEnumerable}),(function(e,t,n){var r=n(30);e.exports=function(e){return Object(r(e))}}),(function(e,t){e.exports=!0}),(function(e,t,n){var r=n(4).f,i=n(10),o=n(1)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,o)&&r(e,o,{configurable:!0,value:t})}}),(function(e,t,n){n(78);for(var r=n(2),i=n(8),o=n(14),s=n(1)("toStringTag"),a="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;u<a.length;u++){var c=a[u],l=r[c],f=l&&l.prototype;f&&!f[s]&&i(f,s,c),o[c]=o.Array}}),(function(e,t,n){var r=n(9),i=n(2).document,o=r(i)&&r(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}}),(function(e,t,n){var r=n(9);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}}),(function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}}),(function(e,t,n){var r=n(32),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}}),(function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}}),(function(e,t,n){var r=n(34)("keys"),i=n(22);e.exports=function(e){return r[e]||(r[e]=i(e))}}),(function(e,t,n){var r=n(2),i=r["__core-js_shared__"]||(r["__core-js_shared__"]={});e.exports=function(e){return i[e]||(i[e]={})}}),(function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")}),(function(e,t){t.f=Object.getOwnPropertySymbols}),(function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}}),(function(e,t,n){e.exports={default:n(71),__esModule:!0}}),(function(e,t,n){var r=n(19),i=n(1)("toStringTag"),o="Arguments"==r(function(){return arguments}()),s=function(e,t){try{return e[t]}catch(e){}};e.exports=function(e){var t,n,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=s(t=Object(e),i))?n:o?r(t):"Object"==(a=r(t))&&"function"==typeof t.callee?"Arguments":a}}),(function(e,t,n){var r=n(39),i=n(1)("iterator"),o=n(14);e.exports=n(0).getIteratorMethod=function(e){if(void 0!=e)return e[i]||e["@@iterator"]||o[r(e)]}}),(function(e,t,n){"use strict";function r(e){var t,n;this.promise=new e(function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r}),this.resolve=i(t),this.reject=i(n)}var i=n(21);e.exports.f=function(e){return new r(e)}}),(function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var i=n(113),o=r(i),s=n(115),a=r(s),u="function"==typeof a.default&&"symbol"==typeof o.default?function(e){return typeof e}:function(e){return e&&"function"==typeof a.default&&e.constructor===a.default&&e!==a.default.prototype?"symbol":typeof e};t.default="function"==typeof a.default&&"symbol"===u(o.default)?function(e){return void 0===e?"undefined":u(e)}:function(e){return e&&"function"==typeof a.default&&e.constructor===a.default&&e!==a.default.prototype?"symbol":void 0===e?"undefined":u(e)}}),(function(e,t,n){t.f=n(1)}),(function(e,t,n){var r=n(2),i=n(0),o=n(25),s=n(43),a=n(4).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=o?{}:r.Symbol||{});"_"==e.charAt(0)||e in t||a(t,e,{value:s.f(e)})}}),(function(e,t,n){e.exports={default:n(66),__esModule:!0}}),(function(e,t,n){e.exports=!n(7)&&!n(11)((function(){return 7!=Object.defineProperty(n(28)("div"),"a",{get:function(){return 7}}).a}))}),(function(e,t,n){var r=n(10),i=n(12),o=n(69)(!1),s=n(33)("IE_PROTO");e.exports=function(e,t){var n,a=i(e),u=0,c=[];for(n in a)n!=s&&r(a,n)&&c.push(n);for(;t.length>u;)r(a,n=t[u++])&&(~o(c,n)||c.push(n));return c}}),(function(e,t,n){var r=n(19);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}}),(function(e,t){}),(function(e,t,n){"use strict";var r=n(25),i=n(3),o=n(51),s=n(8),a=n(10),u=n(14),c=n(75),l=n(26),f=n(77),d=n(1)("iterator"),p=!([].keys&&"next"in[].keys()),h=function(){return this};e.exports=function(e,t,n,g,v,m,b){c(n,t,g);var y,_,w,x=function(e){if(!p&&e in k)return k[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},A=t+" Iterator",S="values"==v,M=!1,k=e.prototype,T=k[d]||k["@@iterator"]||v&&k[v],C=!p&&T||x(v),I=v?S?x("entries"):C:void 0,E="Array"==t?k.entries||T:T;if(E&&(w=f(E.call(new e)))!==Object.prototype&&w.next&&(l(w,A,!0),r||a(w,d)||s(w,d,h)),S&&T&&"values"!==T.name&&(M=!0,C=function(){return T.call(this)}),r&&!b||!p&&!M&&k[d]||s(k,d,C),u[t]=C,u[A]=h,v)if(y={values:S?C:x("values"),keys:m?C:x("keys"),entries:I},b)for(_ in y)_ in k||o(k,_,y[_]);else i(i.P+i.F*(p||M),t,y);return y}}),(function(e,t,n){e.exports=n(8)}),(function(e,t,n){var r=n(5),i=n(76),o=n(35),s=n(33)("IE_PROTO"),a=function(){},u=function(){var e,t=n(28)("iframe"),r=o.length;for(t.style.display="none",n(53).appendChild(t),t.src="javascript:",e=t.contentWindow.document,e.open(),e.write("<script>document.F=Object<\/script>"),e.close(),u=e.F;r--;)delete u.prototype[o[r]];return u()};e.exports=Object.create||function(e,t){var n;return null!==e?(a.prototype=r(e),n=new a,a.prototype=null,n[s]=e):n=u(),void 0===t?n:i(n,t)}}),(function(e,t,n){var r=n(2).document;e.exports=r&&r.documentElement}),(function(e,t,n){var r=n(5);e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(t){var o=e.return;throw void 0!==o&&r(o.call(e)),t}}}),(function(e,t,n){var r=n(14),i=n(1)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||o[i]===e)}}),(function(e,t,n){var r=n(5),i=n(21),o=n(1)("species");e.exports=function(e,t){var n,s=r(e).constructor;return void 0===s||void 0==(n=r(s)[o])?t:i(n)}}),(function(e,t,n){var r,i,o,s=n(16),a=n(84),u=n(53),c=n(28),l=n(2),f=l.process,d=l.setImmediate,p=l.clearImmediate,h=l.MessageChannel,g=l.Dispatch,v=0,m={},b=function(){var e=+this;if(m.hasOwnProperty(e)){var t=m[e];delete m[e],t()}},y=function(e){b.call(e.data)};d&&p||(d=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return m[++v]=function(){a("function"==typeof e?e:Function(e),t)},r(v),v},p=function(e){delete m[e]},"process"==n(19)(f)?r=function(e){f.nextTick(s(b,e,1))}:g&&g.now?r=function(e){g.now(s(b,e,1))}:h?(i=new h,o=i.port2,i.port1.onmessage=y,r=s(o.postMessage,o,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(r=function(e){l.postMessage(e+"","*")},l.addEventListener("message",y,!1)):r="onreadystatechange"in c("script")?function(e){u.appendChild(c("script")).onreadystatechange=function(){u.removeChild(this),b.call(e)}}:function(e){setTimeout(s(b,e,1),0)}),e.exports={set:d,clear:p}}),(function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}}),(function(e,t,n){var r=n(5),i=n(9),o=n(41);e.exports=function(e,t){if(r(e),i(t)&&t.constructor===e)return t;var n=o.f(e);return(0,n.resolve)(t),n.promise}}),(function(e,t,n){var r=n(1)("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var o=[7],s=o[r]();s.next=function(){return{done:n=!0}},o[r]=function(){return s},e(o)}catch(e){}return n}}),(function(e,t,n){e.exports={default:n(96),__esModule:!0}}),(function(e,t,n){var r=n(47),i=n(35).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}}),(function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var i=n(126),o=r(i),s=n(129),a=r(s);t.default=(function(){function e(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var s,u=(0,a.default)(e);!(r=(s=u.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if((0,o.default)(Object(t)))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})()}),(function(e,t,n){"use strict";t.__esModule=!0;var r=n(38),i=(function(e){return e&&e.__esModule?e:{default:e}})(r);t.default=(function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),(0,i.default)(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}})()}),(function(e,t,n){"use strict";function r(e){n(101)}function i(e){n(109)}function o(e){n(100)}function s(e){n(110)}function a(e){n(99)}function u(e){n(112)}function c(e){n(111)}function l(e){n(95)}function f(e,t){function n(e,t,n,r){return n in t?r&&"object"===st()(e[n])?p()({},f(t[n],e[n],r),f(e[n],t[n],r)):"object"===st()(e[n])?p()({},e[n],t[n]):t[n]:e[n]}var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return E()(e).map((function(i){var o=n(e,t,i,r);return ut()({},i,o)})).reduce((function(e,t){return p()({},e,t)}),{})}Object.defineProperty(t,"__esModule",{value:!0});var d=n(15),p=n.n(d),h=n(37),g=n.n(h),v=n(38),m=n.n(v),b=n(13),y=n.n(b),_=n(90),w=n.n(_),x=n(91),A=n.n(x),S=n(92),M=n(93),k=n.n(M),T=n(94),C=n.n(T),I=n(61),E=n.n(I),P={name:"toolbar-container",data:function(){return{shouldShowTooltip:!1,tooltipEventHandlers:{mouseenter:this.onInputButtonHoverEnter,mouseleave:this.onInputButtonHoverLeave,touchstart:this.onInputButtonHoverEnter,touchend:this.onInputButtonHoverLeave,touchcancel:this.onInputButtonHoverLeave}}},props:["toolbarTitle","toolbarColor","toolbarLogo","isUiMinimized"],computed:{toolTipMinimize:function(){return this.isUiMinimized?"maximize":"minimize"}},methods:{onInputButtonHoverEnter:function(){this.shouldShowTooltip=!0},onInputButtonHoverLeave:function(){this.shouldShowTooltip=!1},toggleMinimize:function(){this.onInputButtonHoverLeave(),this.$emit("toggleMinimizeUi")}}},R=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-toolbar",{attrs:{color:e.toolbarColor,app:"",dark:"",dense:"",fixed:""}},[e.toolbarLogo?n("img",{attrs:{src:e.toolbarLogo}}):e._e(),e._v(" "),n("v-toolbar-title",{staticClass:"hidden-xs-and-down"},[e._v("\n    "+e._s(e.toolbarTitle)+"\n  ")]),e._v(" "),n("v-spacer"),e._v(" "),n("v-tooltip",{attrs:{activator:".min-max-toggle",left:""},model:{value:e.shouldShowTooltip,callback:function(t){e.shouldShowTooltip=t},expression:"shouldShowTooltip"}},[n("span",{attrs:{id:"min-max-tooltip"}},[e._v(e._s(e.toolTipMinimize))])]),e._v(" "),e.$store.state.isRunningEmbedded?n("v-btn",e._g({staticClass:"min-max-toggle",attrs:{icon:""},on:{click:e.toggleMinimize}},e.tooltipEventHandlers),[n("v-icon",[e._v("\n      "+e._s(e.isUiMinimized?"arrow_drop_up":"arrow_drop_down")+"\n    ")])],1):e._e()],1)},O=[],B={render:R,staticRenderFns:O},L=B,j=n(6),F=j(P,L,!1,null,null,null),$=F.exports,D=n(102),U=D.markdown,N={name:"message-text",props:["message"],computed:{shouldConvertUrlToLinks:function(){return this.$store.state.config.ui.convertUrlToLinksInBotMessages},shouldStripTags:function(){return this.$store.state.config.ui.stripTagsFromBotMessages},AllowSuperDangerousHTMLInMessage:function(){return this.$store.state.config.ui.AllowSuperDangerousHTMLInMessage},altHtmlMessage:function(){var e=!1;return this.message.alts&&(this.message.alts.html?e=this.message.alts.html:this.message.alts.markdown&&(e=U.toHTML(this.message.alts.markdown))),e},shouldRenderAsHtml:function(){return"bot"===this.message.type&&this.shouldConvertUrlToLinks},botMessageAsHtml:function(){var e=this.stripTagsFromMessage(this.message.text);return this.botMessageWithLinks(e)}},methods:{encodeAsHtml:function(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},botMessageWithLinks:function(e){var t=this;return[{type:"web",regex:new RegExp("\\b((?:https?://\\w{1}|www\\.)(?:[\\w-.]){2,256}(?:[\\w._~:/?#@!$&()*+,;=['\\]-]){0,256})","im"),replace:function(e){var n=/^https?:\/\//.test(e)?e:"http://"+e;return'<a target="_blank" href="'+encodeURI(n)+'">'+t.encodeAsHtml(e)+"</a>"}}].reduce((function(e,n){return e.split(n.regex).reduce((function(e,r,i,o){var s="";if(i%2==0){var a=i+1===o.length?"":n.replace(o[i+1]);s=""+t.encodeAsHtml(r)+a}return e+s}),"")}),e)},stripTagsFromMessage:function(e){var t=document.implementation.createHTMLDocument("").body;return t.innerHTML=e,t.textContent||t.innerText||""}}},q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.message.text&&"human"===e.message.type?n("div",{staticClass:"message-text"},[e._v("\n  "+e._s(e.message.text)+"\n")]):e.altHtmlMessage&&e.AllowSuperDangerousHTMLInMessage?n("div",{staticClass:"message-text",domProps:{innerHTML:e._s(e.altHtmlMessage)}}):e.message.text&&e.shouldRenderAsHtml?n("div",{staticClass:"message-text",domProps:{innerHTML:e._s(e.botMessageAsHtml)}}):e.message.text&&"bot"===e.message.type?n("div",{staticClass:"message-text"},[e._v("\n  "+e._s(e.shouldStripTags?e.stripTagsFromMessage(e.message.text):e.message.text)+"\n")]):e._e()},z=[],H={render:q,staticRenderFns:z},W=H,G=n(6),V=r,Q=G(N,W,!1,V,"data-v-023d6f1a",null),J=Q.exports,K={name:"response-card",props:["response-card"],data:function(){return{hasButtonBeenClicked:!1}},computed:{},methods:{onButtonClick:function(e){this.hasButtonBeenClicked=!0;var t={type:"human",text:e};this.$store.dispatch("postTextMessage",t)}}},Y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card",[e.responseCard.title.trim()?n("v-card-title",{staticClass:"red lighten-5",attrs:{"primary-title":""}},[n("span",{staticClass:"headline"},[e._v(e._s(e.responseCard.title))])]):e._e(),e._v(" "),e.responseCard.subTitle?n("v-card-text",[n("span",[e._v(e._s(e.responseCard.subTitle))])]):e._e(),e._v(" "),e.responseCard.imageUrl?n("v-card-media",{attrs:{src:e.responseCard.imageUrl,contain:"",height:"33vh"}}):e._e(),e._v(" "),e._l(e.responseCard.buttons,(function(t,r){return n("v-card-actions",{key:r,staticClass:"button-row",attrs:{actions:""}},[t.text&&t.value?n("v-btn",{attrs:{disabled:e.hasButtonBeenClicked,default:""},nativeOn:{"~click":function(n){e.onButtonClick(t.value)}}},[e._v("\n      "+e._s(t.text)+"\n    ")]):e._e()],1)})),e._v(" "),e.responseCard.attachmentLinkUrl?n("v-card-actions",[n("v-btn",{staticClass:"red lighten-5",attrs:{flat:"",tag:"a",href:e.responseCard.attachmentLinkUrl,target:"_blank"}},[e._v("\n      Open Link\n    ")])],1):e._e()],2)},X=[],Z={render:Y,staticRenderFns:X},ee=Z,te=n(6),ne=i,re=te(K,ee,!1,ne,"data-v-19ae77ba",null),ie=re.exports,oe={name:"message",props:["message"],components:{MessageText:J,ResponseCard:ie},data:function(){return{isMessageFocused:!1,messageHumanDate:"Now"}},computed:{botDialogState:function(){if(!("dialogState"in this.message))return null;switch(this.message.dialogState){case"Failed":return{icon:"error",color:"red",state:"fail"};case"Fulfilled":case"ReadyForFulfillment":return{icon:"done",color:"green",state:"ok"};default:return null}},botAvatarUrl:function(){return this.$store.state.config.ui.avatarImageUrl},shouldDisplayResponseCard:function(){return this.message.responseCard&&("1"===this.message.responseCard.version||1===this.message.responseCard.version)&&"application/vnd.amazonaws.card.generic"===this.message.responseCard.contentType&&"genericAttachments"in this.message.responseCard&&this.message.responseCard.genericAttachments instanceof Array},shouldShowAvatarImage:function(){return"bot"===this.message.type&&this.botAvatarUrl},botAvatarBackground:function(){return{background:"url("+this.botAvatarUrl+") center center / contain no-repeat"}},shouldShowMessageDate:function(){return this.$store.state.config.ui.showMessageDate}},methods:{playAudio:function(){var e=this.$el.querySelector("audio");e&&e.play()},onMessageFocus:function(){this.shouldShowMessageDate&&(this.messageHumanDate=this.getMessageHumanDate(),this.isMessageFocused=!0,this.message.id===this.$store.state.messages.length-1&&this.$emit("scrollDown"))},onMessageBlur:function(){this.shouldShowMessageDate&&(this.isMessageFocused=!1)},getMessageHumanDate:function(){var e=Math.round((new Date-this.message.date)/1e3);return e<60?"Now":e<3600?Math.floor(e/60)+" min":e<86400?this.message.date.toLocaleTimeString():this.message.date.toLocaleString()}}},se=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-flex",{staticClass:"message",attrs:{"d-flex":""}},[n("v-layout",{staticClass:"message-layout",attrs:{column:"","ma-2":""}},[n("v-flex",{staticClass:"message-bubble-date-container",attrs:{"d-flex":""}},[n("v-layout",{staticClass:"message-bubble-column",attrs:{column:""}},[n("v-flex",{staticClass:"message-bubble-avatar-container",attrs:{"d-flex":""}},[n("v-layout",{staticClass:"message-bubble-row",attrs:{row:""}},[e.shouldShowAvatarImage?n("div",{staticClass:"bot-avatar focusable",style:e.botAvatarBackground,attrs:{tabindex:e.message.id+1}}):e._e(),e._v(" "),n("div",{staticClass:"message-bubble focusable",attrs:{tabindex:e.message.id+1},on:{focus:e.onMessageFocus,blur:e.onMessageBlur}},["text"in e.message&&null!==e.message.text&&e.message.text.length?n("message-text",{attrs:{message:e.message}}):e._e(),e._v(" "),"human"===e.message.type&&e.message.audio?n("div",{staticClass:"message-audio"},[n("audio",[n("source",{attrs:{src:e.message.audio,type:"audio/wav"}})]),e._v(" "),n("v-btn",{staticClass:"black--text ml-0 mr-0",attrs:{tabindex:e.message.id+1,icon:""},on:{click:e.playAudio}},[n("v-icon",{staticClass:"play-icon"},[e._v("play_circle_outline")])],1)],1):e._e(),e._v(" "),"bot"===e.message.type&&e.botDialogState?n("v-icon",{staticClass:"dialog-state",class:"dialog-state-"+e.botDialogState.state,attrs:{medium:""}},[e._v("\n                "+e._s(e.botDialogState.icon)+"\n              ")]):e._e()],1)])],1),e._v(" "),e.shouldShowMessageDate&&e.isMessageFocused?n("v-flex",{staticClass:"text-xs-center message-date"},[e._v("\n          "+e._s(e.messageHumanDate)+"\n        ")]):e._e()],1)],1),e._v(" "),e.shouldDisplayResponseCard?n("v-flex",{staticClass:"response-card",attrs:{"d-flex":"","mt-2":"","mr-2":"","ml-3":""}},e._l(e.message.responseCard.genericAttachments,(function(e,t){return n("response-card",{key:t,attrs:{"response-card":e}})}))):e._e()],1)],1)},ae=[],ue={render:se,staticRenderFns:ae},ce=ue,le=n(6),fe=o,de=le(oe,ce,!1,fe,"data-v-f26fa868",null),pe=de.exports,he={name:"messageLoading",data:function(){return{progress:"."}},computed:{},methods:{},created:function(){var e=this;this.interval=setInterval((function(){e.progress.length>2?e.progress=".":e.progress+="."}),500)},destroyed:function(){clearInterval(this.interval)}},ge=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-flex",{staticClass:"message message-bot",attrs:{"d-flex":""}},[n("v-layout",{staticClass:"message-layout",attrs:{column:"","ma-2":""}},[n("v-flex",{staticClass:"message-bubble-date-container",attrs:{"d-flex":""}},[n("v-layout",{staticClass:"message-bubble-column",attrs:{column:""}},[n("v-flex",{staticClass:"message-bubble-avatar-container",attrs:{"d-flex":""}},[n("v-layout",{staticClass:"message-bubble-row",attrs:{row:""}},[n("div",{staticClass:"message-bubble focusable"},[e._v("\n              "+e._s(e.progress)+" \n            ")])])],1)],1)],1)],1)],1)},ve=[],me={render:ge,staticRenderFns:ve},be=me,ye=n(6),_e=s,we=ye(he,be,!1,_e,"data-v-6d624218",null),xe=we.exports,Ae={name:"message-list",components:{Message:pe,MessageLoading:xe},computed:{messages:function(){return this.$store.state.messages},loading:function(){return this.$store.state.lex.isProcessing}},watch:{messages:function(){this.scrollDown()}},methods:{scrollDown:function(){var e=this;return this.$nextTick((function(){e.$el.scrollTop=e.$el.scrollHeight}))}}},Se=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-layout",{staticClass:"message-list",attrs:{column:"","fill-height":""}},[e._l(e.messages,(function(t){return n("message",{key:t.id,ref:"messages",refInFor:!0,class:"message-"+t.type,attrs:{message:t},on:{scrollDown:e.scrollDown}})})),e._v(" "),e.loading?n("MessageLoading"):e._e()],2)},Me=[],ke={render:Se,staticRenderFns:Me},Te=ke,Ce=n(6),Ie=a,Ee=Ce(Ae,Te,!1,Ie,"data-v-6f155304",null),Pe=Ee.exports,Re={name:"recorder-status",data:function(){return{volume:0,volumeIntervalId:null,audioPlayPercent:0,audioIntervalId:null}},computed:{isSpeechConversationGoing:function(){return this.isConversationGoing},isProcessing:function(){return this.isSpeechConversationGoing&&!this.isRecording&&!this.isBotSpeaking},statusText:function(){return this.isInterrupting?"Interrupting...":this.canInterruptBotPlayback?'Say "skip" and I\'ll listen for your answer...':this.isMicMuted?"Microphone seems to be muted...":this.isRecording?"Listening...":this.isBotSpeaking?"Playing audio...":this.isSpeechConversationGoing?"Processing...":this.isRecorderSupported?"Click on the mic":""},canInterruptBotPlayback:function(){return this.$store.state.botAudio.canInterrupt},isBotSpeaking:function(){return this.$store.state.botAudio.isSpeaking},isConversationGoing:function(){return this.$store.state.recState.isConversationGoing},isInterrupting:function(){return this.$store.state.recState.isInterrupting||this.$store.state.botAudio.isInterrupting},isMicMuted:function(){return this.$store.state.recState.isMicMuted},isRecorderSupported:function(){return this.$store.state.recState.isRecorderSupported},isRecording:function(){return this.$store.state.recState.isRecording}},methods:{enterMeter:function(){var e=this;this.volumeIntervalId=setInterval((function(){e.$store.dispatch("getRecorderVolume").then((function(t){e.volume=t.instant.toFixed(4)}))}),50)},leaveMeter:function(){this.volumeIntervalId&&clearInterval(this.volumeIntervalId)},enterAudioPlay:function(){var e=this;this.audioIntervalId=setInterval((function(){e.$store.dispatch("getAudioProperties").then((function(t){var n=t.end,r=void 0===n?0:n,i=t.duration,o=void 0===i?0:i,s=o<=0?0:r/o*100;e.audioPlayPercent=10*Math.ceil(s/10)+5}))}),20)},leaveAudioPlay:function(){this.audioIntervalId&&(this.audioPlayPercent=0,clearInterval(this.audioIntervalId))}}},Oe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-flex",{staticClass:"recorder-status white"},[n("div",{staticClass:"status-text"},[n("span",[e._v(e._s(e.statusText))])]),e._v(" "),n("div",{staticClass:"voice-controls ml-2"},[n("transition",{attrs:{css:!1},on:{enter:e.enterMeter,leave:e.leaveMeter}},[e.isRecording?n("div",{staticClass:"volume-meter"},[n("meter",{attrs:{value:e.volume,min:"0.0001",low:"0.005",optimum:"0.04",high:"0.07",max:"0.09"}})]):e._e()]),e._v(" "),e.isProcessing?n("v-progress-linear",{staticClass:"processing-bar ma-0",attrs:{indeterminate:!0}}):e._e(),e._v(" "),n("transition",{attrs:{css:!1},on:{enter:e.enterAudioPlay,leave:e.leaveAudioPlay}},[e.isBotSpeaking?n("v-progress-linear",{staticClass:"audio-progress-bar ma-0",model:{value:e.audioPlayPercent,callback:function(t){e.audioPlayPercent=t},expression:"audioPlayPercent"}}):e._e()],1)],1)])},Be=[],Le={render:Oe,staticRenderFns:Be},je=Le,Fe=n(6),$e=u,De=Fe(Re,je,!1,$e,"data-v-85675648",null),Ue=De.exports,Ne={name:"input-container",data:function(){return{textInput:"",isTextFieldFocused:!1,shouldShowTooltip:!1,tooltipEventHandlers:{mouseenter:this.onInputButtonHoverEnter,mouseleave:this.onInputButtonHoverLeave,touchstart:this.onInputButtonHoverEnter,touchend:this.onInputButtonHoverLeave,touchcancel:this.onInputButtonHoverLeave}}},props:["textInputPlaceholder","initialSpeechInstruction"],components:{RecorderStatus:Ue},computed:{isBotSpeaking:function(){return this.$store.state.botAudio.isSpeaking},isSpeechConversationGoing:function(){return this.$store.state.recState.isConversationGoing},isMicButtonDisabled:function(){return this.isMicMuted},isMicMuted:function(){return this.$store.state.recState.isMicMuted},isRecorderSupported:function(){return this.$store.state.recState.isRecorderSupported},isRecorderEnabled:function(){return this.$store.state.recState.isRecorderEnabled},isSendButtonDisabled:function(){return this.textInput.length<1},micButtonIcon:function(){return this.isMicMuted?"mic_off":this.isBotSpeaking||this.isSpeechConversationGoing?"stop":"mic"},inputButtonTooltip:function(){return this.shouldShowSendButton?"send":this.isMicMuted?"mic seems to be muted":this.isBotSpeaking||this.isSpeechConversationGoing?"interrupt":"click to use voice"},shouldShowSendButton:function(){return this.textInput.length&&this.isTextFieldFocused||!this.isRecorderSupported||!this.isRecorderEnabled},shouldShowTextInput:function(){return!(this.isBotSpeaking||this.isSpeechConversationGoing)}},methods:{onInputButtonHoverEnter:function(){this.shouldShowTooltip=!0},onInputButtonHoverLeave:function(){this.shouldShowTooltip=!1},onMicClick:function(){return this.onInputButtonHoverLeave(),this.isBotSpeaking||this.isSpeechConversationGoing?this.$store.dispatch("interruptSpeechConversation"):this.isSpeechConversationGoing?y.a.resolve():this.startSpeechConversation()},onTextFieldFocus:function(){this.isTextFieldFocused=!0},onTextFieldBlur:function(){!this.textInput.length&&this.isTextFieldFocused&&(this.isTextFieldFocused=!1)},playInitialInstruction:function(){var e=this;return["","Fulfilled","Failed"].some((function(t){return e.$store.state.lex.dialogState===t}))?this.$store.dispatch("pollySynthesizeSpeech",this.initialSpeechInstruction):y.a.resolve()},postTextMessage:function(){var e=this;if(this.onInputButtonHoverLeave(),this.textInput=this.textInput.trim(),!this.textInput.length)return y.a.resolve();var t={type:"human",text:this.textInput};return this.$store.dispatch("postTextMessage",t).then((function(){e.textInput=""}))},startSpeechConversation:function(){var e=this;return this.isMicMuted?y.a.resolve():this.setAutoPlay().then((function(){return e.playInitialInstruction()})).then((function(){return e.$store.dispatch("startConversation")})).catch((function(t){var n=e.$store.state.config.ui.showErrorDetails?" "+t:"";e.$store.dispatch("pushErrorMessage","Sorry, I couldn't start the conversation. Please try again."+n)}))},setAutoPlay:function(){return this.$store.state.botAudio.autoPlay?y.a.resolve():this.$store.dispatch("setAudioAutoPlay")}}},qe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-footer",{attrs:{app:"",fixed:""}},[n("v-layout",{staticClass:"input-container",attrs:{row:"","justify-space-between":"","ma-0":""}},[n("v-toolbar",{attrs:{color:"white",dense:""}},[n("v-text-field",{directives:[{name:"show",rawName:"v-show",value:e.shouldShowTextInput,expression:"shouldShowTextInput"}],attrs:{label:e.textInputPlaceholder,id:"text-input",name:"text-input","single-line":"","hide-details":""},on:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;t.stopPropagation(),e.postTextMessage(t)},focus:e.onTextFieldFocus,blur:e.onTextFieldBlur},model:{value:e.textInput,callback:function(t){e.textInput=t},expression:"textInput"}}),e._v(" "),n("recorder-status",{directives:[{name:"show",rawName:"v-show",value:!e.shouldShowTextInput,expression:"!shouldShowTextInput"}]}),e._v(" "),n("v-tooltip",{ref:"tooltip",attrs:{activator:".input-button",left:""},model:{value:e.shouldShowTooltip,callback:function(t){e.shouldShowTooltip=t},expression:"shouldShowTooltip"}},[n("span",{attrs:{id:"input-button-tooltip"}},[e._v(e._s(e.inputButtonTooltip))])]),e._v(" "),e.shouldShowSendButton?n("v-btn",e._g({ref:"send",staticClass:"black--text input-button",attrs:{disabled:e.isSendButtonDisabled,icon:""},on:{click:e.postTextMessage}},e.tooltipEventHandlers),[n("v-icon",{attrs:{medium:""}},[e._v("send")])],1):n("v-btn",e._g({ref:"mic",staticClass:"black--text input-button",attrs:{disabled:e.isMicButtonDisabled,icon:""},on:{click:e.onMicClick}},e.tooltipEventHandlers),[n("v-icon",{attrs:{medium:""}},[e._v(e._s(e.micButtonIcon))])],1)],1)],1)],1)},ze=[],He={render:qe,staticRenderFns:ze},We=He,Ge=n(6),Ve=c,Qe=Ge(Ne,We,!1,Ve,null,null),Je=Qe.exports,Ke={name:"lex-web",components:{ToolbarContainer:$,MessageList:Pe,InputContainer:Je},computed:{initialSpeechInstruction:function(){return this.$store.state.config.lex.initialSpeechInstruction},textInputPlaceholder:function(){return this.$store.state.config.ui.textInputPlaceholder},toolbarColor:function(){return this.$store.state.config.ui.toolbarColor},toolbarTitle:function(){return this.$store.state.config.ui.toolbarTitle},toolbarLogo:function(){return this.$store.state.config.ui.toolbarLogo},isUiMinimized:function(){return this.$store.state.isUiMinimized},lexState:function(){return this.$store.state.lex},isMobile:function(){return this.$vuetify.breakpoint.smAndDown&&"navigator"in window&&navigator.maxTouchPoints>0&&"screen"in window&&(window.screen.height<900||window.screen.width<900)}},watch:{lexState:function(){this.$emit("updateLexState",this.lexState)}},created:function(){var e=this;this.isMobile||(document.documentElement.style.overflowY="hidden"),this.initConfig().then((function(){return y.a.all([e.$store.dispatch("initCredentials",e.$lexWebUi.awsConfig.credentials),e.$store.dispatch("initRecorder"),e.$store.dispatch("initBotAudio",window.Audio?new Audio:null)])})).then((function(){return y.a.all([e.$store.dispatch("initMessageList"),e.$store.dispatch("initPollyClient",e.$lexWebUi.pollyClient),e.$store.dispatch("initLexClient",e.$lexWebUi.lexRuntimeClient)])})).then((function(){return e.$store.state.isRunningEmbedded?e.$store.dispatch("sendMessageToParentWindow",{event:"ready"}):y.a.resolve()})).then((function(){})).catch((function(e){}))},methods:{toggleMinimizeUi:function(){return this.$store.dispatch("toggleIsUiMinimized")},messageHandler:function(e){if(e.origin===this.$store.state.config.ui.parentOrigin&&e.ports&&Array.isArray(e.ports)&&e.ports.length)switch(e.data.event){case"ping":case"parentReady":e.ports[0].postMessage({event:"resolve",type:e.data.event});break;case"toggleMinimizeUi":this.$store.dispatch("toggleIsUiMinimized").then((function(){return e.ports[0].postMessage({event:"resolve",type:e.data.event})}));break;case"postText":if(!e.data.message)return void e.ports[0].postMessage({event:"reject",type:e.data.event,error:"missing message field"});this.$store.dispatch("postTextMessage",{type:"human",text:e.data.message}).then((function(){return e.ports[0].postMessage({event:"resolve",type:e.data.event})}))}},logRunningMode:function(){this.$store.state.isRunningEmbedded&&document.referrer.startsWith(this.$store.state.config.ui.parentOrigin)},initConfig:function(){var e=this;return"true"!==this.$store.state.config.urlQueryParams.lexWebUiEmbed?(this.$store.commit("setIsRunningEmbedded",!1),this.$store.commit("setAwsCredsProvider","cognito")):(window.addEventListener("message",this.messageHandler,!1),this.$store.commit("setIsRunningEmbedded",!0),this.$store.commit("setAwsCredsProvider","parentWindow")),this.$store.dispatch("initConfig",this.$lexWebUi.config).then((function(){return e.$store.dispatch("getConfigFromParent")})).then((function(t){return E()(t).length?e.$store.dispatch("initConfig",t):y.a.resolve()})).then((function(){return e.logRunningMode()}))}}},Ye=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",{attrs:{id:"lex-web"}},[n("toolbar-container",{attrs:{"toolbar-title":e.toolbarTitle,"toolbar-color":e.toolbarColor,"toolbar-logo":e.toolbarLogo,"is-ui-minimized":e.isUiMinimized},on:{toggleMinimizeUi:e.toggleMinimizeUi}}),e._v(" "),n("v-content",[n("v-container",{staticClass:"message-list-container",attrs:{fluid:"","pa-0":""}},[n("message-list",{directives:[{name:"show",rawName:"v-show",value:!e.isUiMinimized,expression:"!isUiMinimized"}]})],1)],1),e._v(" "),e.isUiMinimized?e._e():n("input-container",{attrs:{"text-input-placeholder":e.textInputPlaceholder,"initial-speech-instruction":e.initialSpeechInstruction}})],1)},Xe=[],Ze={render:Ye,staticRenderFns:Xe},et=Ze,tt=n(6),nt=l,rt=tt(Ke,et,!1,nt,null,null),it=rt.exports,ot=n(42),st=n.n(ot),at=n(125),ut=n.n(at),ct=n(63),lt=n.n(ct),ft=["dev","prod","test"].find((function(e){return"production".startsWith(e)})),dt=n(132)("./config."+ft+".json"),pt={region:"us-east-1",cognito:{poolId:""},lex:{botName:"WebUiOrderFlowers",botAlias:"$LATEST",initialText:'You can ask me for help ordering flowers. Just type "order flowers" or click on the mic and say it.',initialSpeechInstruction:'Say "Order Flowers" to get started',sessionAttributes:{},reInitSessionAttributesOnRestart:!0,enablePlaybackInterrupt:!1,playbackInterruptVolumeThreshold:-60,playbackInterruptLevelThreshold:.0075,playbackInterruptNoiseThreshold:-75,playbackInterruptMinDuration:2},polly:{voiceId:"Joanna"},ui:{pageTitle:"Order Flowers Bot",parentOrigin:null,textInputPlaceholder:"Type here or click on the mic",toolbarColor:"red",toolbarTitle:"Order Flowers",toolbarLogo:"",favIcon:"",pushInitialTextOnRestart:!0,reInitSessionAttributesOnRestart:!1,convertUrlToLinksInBotMessages:!0,stripTagsFromBotMessages:!0,showErrorDetails:!1,showMessageDate:!0,avatarImageUrl:"",AllowSuperDangerousHTMLInMessage:!1},recorder:{enable:!0,recordingTimeMax:10,recordingTimeMin:2.5,quietThreshold:.002,quietTimeMin:.3,volumeThreshold:-65,useAutoMuteDetect:!1,useBandPass:!1,encoderUseTrim:!1},converser:{silentConsecutiveRecordingMax:3},urlQueryParams:{}},ht=f(pt,dt),gt=(function(e){try{return e.split("?",2).slice(1,2).reduce((function(e,t){return t.split("&")}),[]).map((function(e){return e.split("=")})).reduce((function(e,t){var n=lt()(t,2),r=n[0],i=n[1],o=void 0===i||i,s=ut()({},r,decodeURIComponent(o));return p()({},e,s)}),{})}catch(e){return{}}})(window.location.href),vt=(function(e){try{return e.lexWebUiConfig?JSON.parse(e.lexWebUiConfig):{}}catch(e){return{}}})(gt);vt.ui&&vt.ui.parentOrigin&&delete vt.ui.parentOrigin;var mt=f(ht,vt),bt=p()({},mt,{urlQueryParams:gt}),yt={version:"0.14.0",lex:{acceptFormat:"audio/ogg",dialogState:"",isInterrupting:!1,isProcessing:!1,inputTranscript:"",intentName:"",message:"",responseCard:null,sessionAttributes:bt.lex&&bt.lex.sessionAttributes&&"object"===st()(bt.lex.sessionAttributes)?p()({},bt.lex.sessionAttributes):{},slotToElicit:"",slots:{}},messages:[],polly:{outputFormat:"ogg_vorbis",voiceId:bt.polly&&bt.polly.voiceId&&"string"==typeof bt.polly.voiceId?""+bt.polly.voiceId:"Joanna"},botAudio:{canInterrupt:!1,interruptIntervalId:null,autoPlay:!1,isInterrupting:!1,isSpeaking:!1},recState:{isConversationGoing:!1,isInterrupting:!1,isMicMuted:!1,isMicQuiet:!0,isRecorderSupported:!1,isRecorderEnabled:!bt.recorder||!!bt.recorder.enable,isRecording:!1,silentRecordingCount:0},isRunningEmbedded:!1,isUiMinimized:!1,config:bt,awsCreds:{provider:"cognito"}},_t={canInterruptBotPlayback:function(e){return e.botAudio.canInterrupt},isBotSpeaking:function(e){return e.botAudio.isSpeaking},isConversationGoing:function(e){return e.recState.isConversationGoing},isLexInterrupting:function(e){return e.lex.isInterrupting},isLexProcessing:function(e){return e.lex.isProcessing},isMicMuted:function(e){return e.recState.isMicMuted},isMicQuiet:function(e){return e.recState.isMicQuiet},isRecorderSupported:function(e){return e.recState.isRecorderSupported},isRecording:function(e){return e.recState.isRecording}},wt={setIsMicMuted:function(e,t){"boolean"==typeof t&&e.config.recorder.useAutoMuteDetect&&(e.recState.isMicMuted=t)},setIsMicQuiet:function(e,t){"boolean"==typeof t&&(e.recState.isMicQuiet=t)},setIsConversationGoing:function(e,t){"boolean"==typeof t&&(e.recState.isConversationGoing=t)},startRecording:function(e,t){!1===e.recState.isRecording&&(t.start(),e.recState.isRecording=!0)},stopRecording:function(e,t){!0===e.recState.isRecording&&(e.recState.isRecording=!1,t.isRecording&&t.stop())},increaseSilentRecordingCount:function(e){e.recState.silentRecordingCount+=1},resetSilentRecordingCount:function(e){e.recState.silentRecordingCount=0},setIsRecorderEnabled:function(e,t){"boolean"==typeof t&&(e.recState.isRecorderEnabled=t)},setIsRecorderSupported:function(e,t){"boolean"==typeof t&&(e.recState.isRecorderSupported=t)},setIsBotSpeaking:function(e,t){"boolean"==typeof t&&(e.botAudio.isSpeaking=t)},setAudioAutoPlay:function(e,t){var n=t.audio,r=t.status;"boolean"==typeof r&&(e.botAudio.autoPlay=r,n.autoplay=r)},setCanInterruptBotPlayback:function(e,t){"boolean"==typeof t&&(e.botAudio.canInterrupt=t)},setIsBotPlaybackInterrupting:function(e,t){"boolean"==typeof t&&(e.botAudio.isInterrupting=t)},setBotPlaybackInterruptIntervalId:function(e,t){"number"==typeof t&&(e.botAudio.interruptIntervalId=t)},updateLexState:function(e,t){e.lex=p()({},e.lex,t)},setLexSessionAttributes:function(e,t){"object"===(void 0===t?"undefined":st()(t))&&(e.lex.sessionAttributes=t)},setIsLexProcessing:function(e,t){"boolean"==typeof t&&(e.lex.isProcessing=t)},setIsLexInterrupting:function(e,t){"boolean"==typeof t&&(e.lex.isInterrupting=t)},setAudioContentType:function(e,t){switch(t){case"mp3":case"mpg":case"mpeg":e.polly.outputFormat="mp3",e.lex.acceptFormat="audio/mpeg";break;case"ogg":case"ogg_vorbis":case"x-cbr-opus-with-preamble":default:e.polly.outputFormat="ogg_vorbis",e.lex.acceptFormat="audio/ogg"}},setPollyVoiceId:function(e,t){"string"==typeof t&&(e.polly.voiceId=t)},mergeConfig:function(e,t){if("object"===(void 0===t?"undefined":st()(t))){var n=e.config&&e.config.ui&&e.config.ui.parentOrigin?e.config.ui.parentOrigin:t.ui.parentOrigin||window.location.origin,r=p()({},t,{ui:p()({},t.ui,{parentOrigin:n})});e.config&&e.config.ui&&e.config.ui.parentOrigin&&t.ui&&t.ui.parentOrigin&&(t.ui.parentOrigin,e.config.ui.parentOrigin),e.config=f(e.config,r)}},setIsRunningEmbedded:function(e,t){"boolean"==typeof t&&(e.isRunningEmbedded=t)},toggleIsUiMinimized:function(e){e.isUiMinimized=!e.isUiMinimized},pushMessage:function(e,t){e.messages.push(p()({id:e.messages.length,date:new Date},t))},setAwsCredsProvider:function(e,t){e.awsCreds.provider=t}},xt=n(136),At=n.n(xt),St=n(45),Mt=n.n(St),kt=n(64),Tt=n.n(kt),Ct=n(141),It=n.n(Ct),Et=(function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};g()(this,e),this.initOptions(n),this._eventTarget=document.createDocumentFragment(),this._encoderWorker=new It.a,this._encoderWorker.addEventListener("message",(function(e){return t._exportWav(e.data)}))}return Tt()(e,[{key:"initOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.preset&&Mt()(e,this._getPresetOptions(e.preset)),this.mimeType=e.mimeType||"audio/wav",this.recordingTimeMax=e.recordingTimeMax||8,this.recordingTimeMin=e.recordingTimeMin||2,this.recordingTimeMinAutoIncrease=void 0===e.recordingTimeMinAutoIncrease||!!e.recordingTimeMinAutoIncrease,this.autoStopRecording=void 0===e.autoStopRecording||!!e.autoStopRecording,this.quietThreshold=e.quietThreshold||.001,this.quietTimeMin=e.quietTimeMin||.4,this.volumeThreshold=e.volumeThreshold||-75,this.useBandPass=void 0===e.useBandPass||!!e.useBandPass,this.bandPassFrequency=e.bandPassFrequency||4e3,this.bandPassQ=e.bandPassQ||.707,this.bufferLength=e.bufferLength||2048,this.numChannels=e.numChannels||1,this.requestEchoCancellation=void 0===e.requestEchoCancellation||!!e.requestEchoCancellation,this.useAutoMuteDetect=void 0===e.useAutoMuteDetect||!!e.useAutoMuteDetect,this.muteThreshold=e.muteThreshold||1e-7,this.encoderUseTrim=void 0===e.encoderUseTrim||!!e.encoderUseTrim,this.encoderQuietTrimThreshold=e.encoderQuietTrimThreshold||8e-4,this.encoderQuietTrimSlackBack=e.encoderQuietTrimSlackBack||4e3}},{key:"_getPresetOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"low_latency";return this._presets=["low_latency","speech_recognition"],-1===this._presets.indexOf(e)?{}:{low_latency:{encoderUseTrim:!0,useBandPass:!0},speech_recognition:{encoderUseTrim:!1,useBandPass:!1,useAutoMuteDetect:!1}}[e]}},{key:"init",value:function(){var e=this;return this._state="inactive",this._instant=0,this._slow=0,this._clip=0,this._maxVolume=-1/0,this._isMicQuiet=!0,this._isMicMuted=!1,this._isSilentRecording=!0,this._silentRecordingConsecutiveCount=0,this._initAudioContext().then((function(){return e._initMicVolumeProcessor()})).then((function(){return e._initStream()}))}},{key:"start",value:function(){"inactive"===this._state&&void 0!==this._stream&&(this._state="recording",this._recordingStartTime=this._audioContext.currentTime,this._eventTarget.dispatchEvent(new Event("start")),this._encoderWorker.postMessage({command:"init",config:{sampleRate:this._audioContext.sampleRate,numChannels:this.numChannels,useTrim:this.encoderUseTrim,quietTrimThreshold:this.encoderQuietTrimThreshold,quietTrimSlackBack:this.encoderQuietTrimSlackBack}}))}},{key:"stop",value:function(){"recording"===this._state&&(this._recordingStartTime>this._quietStartTime?(this._isSilentRecording=!0,this._silentRecordingConsecutiveCount+=1,this._eventTarget.dispatchEvent(new Event("silentrecording"))):(this._isSilentRecording=!1,this._silentRecordingConsecutiveCount=0,this._eventTarget.dispatchEvent(new Event("unsilentrecording"))),this._state="inactive",this._recordingStartTime=0,this._encoderWorker.postMessage({command:"exportWav",type:"audio/wav"}),this._eventTarget.dispatchEvent(new Event("stop")))}},{key:"_exportWav",value:function(e){var t=new CustomEvent("dataavailable",{detail:e.data});this._eventTarget.dispatchEvent(t),this._encoderWorker.postMessage({command:"clear"})}},{key:"_recordBuffers",value:function(e){if("recording"===this._state){for(var t=[],n=0;n<e.numberOfChannels;n++)t[n]=e.getChannelData(n);this._encoderWorker.postMessage({command:"record",buffer:t})}}},{key:"_setIsMicMuted",value:function(){if(this.useAutoMuteDetect)return this._instant>=this.muteThreshold?void(this._isMicMuted&&(this._isMicMuted=!1,this._eventTarget.dispatchEvent(new Event("unmute")))):void(!this._isMicMuted&&this._slow<this.muteThreshold&&(this._isMicMuted=!0,this._eventTarget.dispatchEvent(new Event("mute")),"recording"===this._state&&this.stop()))}},{key:"_setIsMicQuiet",value:function(){var e=this._audioContext.currentTime,t=this._maxVolume<this.volumeThreshold||this._slow<this.quietThreshold;!this._isMicQuiet&&t&&(this._quietStartTime=this._audioContext.currentTime,this._eventTarget.dispatchEvent(new Event("quiet"))),this._isMicQuiet&&!t&&(this._quietStartTime=0,this._eventTarget.dispatchEvent(new Event("unquiet"))),this._isMicQuiet=t;var n=this.recordingTimeMinAutoIncrease?this.recordingTimeMin-1+Math.pow(this.recordingTimeMax,1-1/(this._silentRecordingConsecutiveCount+1)):this.recordingTimeMin;this.autoStopRecording&&this._isMicQuiet&&"recording"===this._state&&e-this._recordingStartTime>n&&e-this._quietStartTime>this.quietTimeMin&&this.stop()}},{key:"_initAudioContext",value:function(){var e=this;return window.AudioContext=window.AudioContext||window.webkitAudioContext,window.AudioContext?(this._audioContext=new AudioContext,document.addEventListener("visibilitychange",(function(){document.hidden?e._audioContext.suspend():e._audioContext.resume()})),y.a.resolve()):y.a.reject(new Error("Web Audio API not supported."))}},{key:"_initMicVolumeProcessor",value:function(){var e=this,t=this._audioContext.createScriptProcessor(this.bufferLength,this.numChannels,this.numChannels);return t.onaudioprocess=function(t){"recording"===e._state&&(e._recordBuffers(t.inputBuffer),e._audioContext.currentTime-e._recordingStartTime>e.recordingTimeMax&&e.stop());for(var n=t.inputBuffer.getChannelData(0),r=0,i=0,o=0;o<n.length;++o)r+=n[o]*n[o],Math.abs(n[o])>.99&&(i+=1);e._instant=Math.sqrt(r/n.length),e._slow=.95*e._slow+.05*e._instant,e._clip=n.length?i/n.length:0,e._setIsMicMuted(),e._setIsMicQuiet(),e._analyser.getFloatFrequencyData(e._analyserData),e._maxVolume=Math.max.apply(Math,At()(e._analyserData))},this._micVolumeProcessor=t,y.a.resolve()}},{key:"_initStream",value:function(){var e=this,t={audio:{optional:[{echoCancellation:this.requestEchoCancellation}]}};return navigator.mediaDevices.getUserMedia(t).then((function(t){e._stream=t,e._tracks=t.getAudioTracks(),e._tracks[0].onmute=e._setIsMicMuted,e._tracks[0].onunmute=e._setIsMicMuted;var n=e._audioContext.createMediaStreamSource(t),r=e._audioContext.createGain(),i=e._audioContext.createAnalyser();if(e.useBandPass){var o=e._audioContext.createBiquadFilter();o.type="bandpass",o.frequency.value=e.bandPassFrequency,o.gain.Q=e.bandPassQ,n.connect(o),o.connect(r),i.smoothingTimeConstant=.5}else n.connect(r),i.smoothingTimeConstant=.9;i.fftSize=e.bufferLength,i.minDecibels=-90,i.maxDecibels=-30,r.connect(i),i.connect(e._micVolumeProcessor),e._analyserData=new Float32Array(i.frequencyBinCount),e._analyser=i,e._micVolumeProcessor.connect(e._audioContext.destination),e._eventTarget.dispatchEvent(new Event("streamReady"))}))}},{key:"state",get:function(){return this._state}},{key:"stream",get:function(){return this._stream}},{key:"isMicQuiet",get:function(){return this._isMicQuiet}},{key:"isMicMuted",get:function(){return this._isMicMuted}},{key:"isSilentRecording",get:function(){return this._isSilentRecording}},{key:"isRecording",get:function(){return"recording"===this._state}},{key:"volume",get:function(){return{instant:this._instant,slow:this._slow,clip:this._clip,max:this._maxVolume}}},{key:"onstart",set:function(e){this._eventTarget.addEventListener("start",e)}},{key:"onstop",set:function(e){this._eventTarget.addEventListener("stop",e)}},{key:"ondataavailable",set:function(e){this._eventTarget.addEventListener("dataavailable",e)}},{key:"onerror",set:function(e){this._eventTarget.addEventListener("error",e)}},{key:"onstreamready",set:function(e){this._eventTarget.addEventListener("streamready",e)}},{key:"onmute",set:function(e){this._eventTarget.addEventListener("mute",e)}},{key:"onunmute",set:function(e){this._eventTarget.addEventListener("unmute",e)}},{key:"onsilentrecording",set:function(e){this._eventTarget.addEventListener("silentrecording",e)}},{key:"onunsilentrecording",set:function(e){this._eventTarget.addEventListener("unsilentrecording",e)}},{key:"onquiet",set:function(e){this._eventTarget.addEventListener("quiet",e)}},{key:"onunquiet",set:function(e){this._eventTarget.addEventListener("unquiet",e)}}]),e})(),Pt=Et,Rt=function(e,t){t.onstart=function(){},t.onstop=function(){e.dispatch("stopRecording")},t.onsilentrecording=function(){e.commit("increaseSilentRecordingCount")},t.onunsilentrecording=function(){e.state.recState.silentRecordingCount>0&&e.commit("resetSilentRecordingCount")},t.onerror=function(e){},t.onstreamready=function(){},t.onmute=function(){e.commit("setIsMicMuted",!0)},t.onunmute=function(){e.commit("setIsMicMuted",!1)},t.onquiet=function(){e.commit("setIsMicQuiet",!0)},t.onunquiet=function(){e.commit("setIsMicQuiet",!1)},t.ondataavailable=function(n){var r=t.mimeType,i=new Blob([n.detail],{type:r}),o=0;r.startsWith("audio/ogg")&&(o=125+n.detail[125]+1),e.dispatch("lexPostContent",i,o).then((function(t){if(e.state.recState.silentRecordingCount>=e.state.config.converser.silentConsecutiveRecordingMax){var n="Too many consecutive silent recordings: "+e.state.recState.silentRecordingCount+".";return y.a.reject(new Error(n))}return y.a.all([e.dispatch("getAudioUrl",i),e.dispatch("getAudioUrl",t)])})).then((function(t){if("Fulfilled"!==e.state.lex.dialogState&&!e.state.recState.isConversationGoing)return y.a.resolve();var n=lt()(t,2),r=n[0],i=n[1];return e.dispatch("pushMessage",{type:"human",audio:r,text:e.state.lex.inputTranscript}),e.dispatch("pushMessage",{type:"bot",audio:i,text:e.state.lex.message,dialogState:e.state.lex.dialogState,responseCard:e.state.lex.responseCard}),e.dispatch("playAudio",i,{},o)})).then((function(){return["Fulfilled","ReadyForFulfillment","Failed"].indexOf(e.state.lex.dialogState)>=0?e.dispatch("stopConversation").then((function(){return e.dispatch("reInitBot")})):e.state.recState.isConversationGoing?e.dispatch("startRecording"):y.a.resolve()})).catch((function(t){var n=e.state.config.ui.showErrorDetails?" "+t:"";e.dispatch("stopConversation"),e.dispatch("pushErrorMessage","Sorry, I had an error handling this conversation."+n),e.commit("resetSilentRecordingCount")}))}},Ot=Rt,Bt=n(143),Lt=n.n(Bt),jt=n(144),Ft=n.n(jt),$t=(function(){function e(t){var n=t.botName,r=t.botAlias,i=void 0===r?"$LATEST":r,o=t.userId,s=t.lexRuntimeClient;if(g()(this,e),!n||!s)throw new Error("invalid lex client constructor arguments");this.botName=n,this.botAlias=i,this.userId=o||"lex-web-ui-"+Math.floor(65536*(1+Math.random())).toString(16).substring(1),this.lexRuntimeClient=s,this.credentials=this.lexRuntimeClient.config.credentials}return Tt()(e,[{key:"initCredentials",value:function(e){this.credentials=e,this.lexRuntimeClient.config.credentials=this.credentials,this.userId=e.identityId?e.identityId:this.userId}},{key:"postText",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.lexRuntimeClient.postText({botAlias:this.botAlias,botName:this.botName,userId:this.userId,inputText:e,sessionAttributes:n});return this.credentials.getPromise().then((function(e){return e&&t.initCredentials(e)})).then((function(){return r.promise()}))}},{key:"postContent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"audio/ogg",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=e.type,s=o;o.startsWith("audio/wav")?s="audio/x-l16; sample-rate=16000; channel-count=1":o.startsWith("audio/ogg")&&(s="audio/x-cbr-opus-with-preamble; bit-rate=32000; frame-size-milliseconds=20; preamble-size="+i);var a=this.lexRuntimeClient.postContent({accept:r,botAlias:this.botAlias,botName:this.botName,userId:this.userId,contentType:s,inputStream:e,sessionAttributes:t});return this.credentials.getPromise().then((function(e){return e&&n.initCredentials(e)})).then((function(){return a.promise()}))}}]),e})(),Dt=$t,Ut=void 0,Nt=void 0,qt=void 0,zt=void 0,Ht=void 0,Wt={initCredentials:function(e,t){switch(e.state.awsCreds.provider){case"cognito":return Ut=t,e.dispatch("getCredentials");case"parentWindow":return e.dispatch("getCredentials");default:return y.a.reject(new Error("unknown credential provider"))}},getConfigFromParent:function(e){return e.state.isRunningEmbedded?e.dispatch("sendMessageToParentWindow",{event:"initIframeConfig"}).then((function(e){return"resolve"===e.event&&"initIframeConfig"===e.type?y.a.resolve(e.data):y.a.reject(new Error("invalid config event from parent"))})):y.a.resolve({})},initConfig:function(e,t){e.commit("mergeConfig",t)},initMessageList:function(e){e.commit("pushMessage",{type:"bot",text:e.state.config.lex.initialText})},initLexClient:function(e,t){return qt=new Dt({botName:e.state.config.lex.botName,botAlias:e.state.config.lex.botAlias,lexRuntimeClient:t}),e.commit("setLexSessionAttributes",e.state.config.lex.sessionAttributes),e.dispatch("getCredentials").then((function(){return qt.initCredentials(Ut)}))},initPollyClient:function(e,t){return e.state.recState.isRecorderEnabled?(Nt=t,e.commit("setPollyVoiceId",e.state.config.polly.voiceId),e.dispatch("getCredentials").then((function(e){Nt.config.credentials=e}))):y.a.resolve()},initRecorder:function(e){return e.state.config.recorder.enable?(Ht=new Pt(e.state.config.recorder),Ht.init().then((function(){return Ht.initOptions(e.state.config.recorder)})).then((function(){return Ot(e,Ht)})).then((function(){return e.commit("setIsRecorderSupported",!0)})).then((function(){return e.commit("setIsMicMuted",Ht.isMicMuted)})).catch((function(t){["PermissionDeniedError","NotAllowedError"].indexOf(t.name)>=0&&e.dispatch("pushErrorMessage","It seems like the microphone access has been denied. If you want to use voice, please allow mic usage in your browser.")}))):(e.commit("setIsRecorderEnabled",!1),y.a.resolve())},initBotAudio:function(e,t){if(!e.state.recState.isRecorderEnabled||!e.state.config.recorder.enable)return y.a.resolve();if(!t)return y.a.reject(new Error("invalid audio element"));zt=t;var n=void 0;return""!==zt.canPlayType("audio/ogg")?(e.commit("setAudioContentType","ogg"),n=Lt.a):""!==zt.canPlayType("audio/mp3")&&(e.commit("setAudioContentType","mp3"),n=Ft.a),zt.preload="auto",zt.src=n,zt.autoplay=!1,y.a.resolve()},reInitBot:function(e){return y.a.resolve().then((function(){return e.state.config.ui.pushInitialTextOnRestart?e.dispatch("pushMessage",{text:e.state.config.lex.initialText,type:"bot"}):y.a.resolve()})).then((function(){return e.state.config.lex.reInitSessionAttributesOnRestart?e.commit("setLexSessionAttributes",e.state.config.lex.sessionAttributes):y.a.resolve()}))},getAudioUrl:function(e,t){var n=void 0;try{n=URL.createObjectURL(t)}catch(e){var r="There was an error processing the audio response: ("+e+")",i=new Error(r);return y.a.reject(i)}return y.a.resolve(n)},setAudioAutoPlay:function(e){return zt.autoplay?y.a.resolve():new y.a(function(t,n){zt.play(),zt.onended=function(){e.commit("setAudioAutoPlay",{audio:zt,status:!0}),t()},zt.onerror=function(t){e.commit("setAudioAutoPlay",{audio:zt,status:!1}),n(new Error("setting audio autoplay failed: "+t))}})},playAudio:function(e,t){return new y.a(function(n){zt.onloadedmetadata=function(){e.commit("setIsBotSpeaking",!0),e.dispatch("playAudioHandler").then((function(){return n()}))},zt.src=t})},playAudioHandler:function(e){return new y.a(function(t,n){var r=e.state.config.lex.enablePlaybackInterrupt,i=function(){e.commit("setIsBotSpeaking",!1);var t=e.state.botAudio.interruptIntervalId;t&&r&&(clearInterval(t),e.commit("setBotPlaybackInterruptIntervalId",0),e.commit("setIsLexInterrupting",!1),e.commit("setCanInterruptBotPlayback",!1),e.commit("setIsBotPlaybackInterrupting",!1))};zt.onerror=function(e){i(),n(new Error("There was an error playing the response ("+e+")"))},zt.onended=function(){i(),t()},zt.onpause=zt.onended,r&&e.dispatch("playAudioInterruptHandler")})},playAudioInterruptHandler:function(e){var t=e.state.botAudio.isSpeaking,n=e.state.config.lex,r=n.enablePlaybackInterrupt,i=n.playbackInterruptMinDuration,o=n.playbackInterruptVolumeThreshold,s=n.playbackInterruptLevelThreshold,a=n.playbackInterruptNoiseThreshold;if(r||t||!e.state.lex.isInterrupting||!(zt.duration<i)){var u=setInterval((function(){var t=zt,n=t.duration,r=zt.played.end(0),c=e.state.botAudio.canInterrupt;!c&&r>i&&n-r>.5&&Ht.volume.max<a?e.commit("setCanInterruptBotPlayback",!0):c&&n-r<.5&&e.commit("setCanInterruptBotPlayback",!1),c&&Ht.volume.max>o&&Ht.volume.slow>s&&(clearInterval(u),e.commit("setIsBotPlaybackInterrupting",!0),setTimeout((function(){zt.pause()}),500))}),200);e.commit("setBotPlaybackInterruptIntervalId",u)}},getAudioProperties:function(){return zt?{currentTime:zt.currentTime,duration:zt.duration,end:zt.played.length>=1?zt.played.end(0):zt.duration,ended:zt.ended,paused:zt.paused}:{}},startConversation:function(e){return e.commit("setIsConversationGoing",!0),e.dispatch("startRecording")},stopConversation:function(e){e.commit("setIsConversationGoing",!1)},startRecording:function(e){return!0===e.state.recState.isMicMuted?(e.dispatch("stopConversation"),y.a.reject(new Error("The microphone seems to be muted."))):(e.commit("startRecording",Ht),y.a.resolve())},stopRecording:function(e){e.commit("stopRecording",Ht)},getRecorderVolume:function(e){return e.state.recState.isRecorderEnabled?Ht.volume:y.a.resolve()},pollyGetBlob:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text",r=Nt.synthesizeSpeech({Text:t,VoiceId:e.state.polly.voiceId,OutputFormat:e.state.polly.outputFormat,TextType:n});return e.dispatch("getCredentials").then((function(){return r.promise()})).then((function(e){var t=new Blob([e.AudioStream],{type:e.ContentType});return y.a.resolve(t)}))},pollySynthesizeSpeech:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text";return e.dispatch("pollyGetBlob",t,n).then((function(t){return e.dispatch("getAudioUrl",t)})).then((function(t){return e.dispatch("playAudio",t)}))},interruptSpeechConversation:function(e){return e.state.recState.isConversationGoing||e.state.botAudio.isSpeaking?new y.a(function(t,n){e.dispatch("stopConversation").then((function(){return e.dispatch("stopRecording")})).then((function(){e.state.botAudio.isSpeaking&&zt.pause()})).then((function(){var r=0;e.commit("setIsLexInterrupting",!0);var i=setInterval((function(){e.state.lex.isProcessing||(clearInterval(i),e.commit("setIsLexInterrupting",!1),t()),r>20&&(clearInterval(i),e.commit("setIsLexInterrupting",!1),n(new Error("interrupt interval exceeded"))),r+=1}),250)}))}):y.a.resolve()},postTextMessage:function(e,t){return e.dispatch("interruptSpeechConversation").then((function(){return e.dispatch("pushMessage",t)})).then((function(){return e.dispatch("lexPostText",t.text)})).then((function(t){return e.dispatch("pushMessage",{text:t.message,type:"bot",dialogState:e.state.lex.dialogState,responseCard:e.state.lex.responseCard,alts:JSON.parse(t.sessionAttributes.appContext||"{}").altMessages})})).then((function(){"Fulfilled"===e.state.lex.dialogState&&e.dispatch("reInitBot")})).catch((function(t){var n=e.state.config.ui.showErrorDetails?" "+t:"";e.dispatch("pushErrorMessage","Sorry, I was unable to process your message. Try again later."+n)}))},lexPostText:function(e,t){return e.commit("setIsLexProcessing",!0),e.dispatch("getCredentials").then((function(){return qt.postText(t,e.state.lex.sessionAttributes)})).then((function(t){return e.commit("setIsLexProcessing",!1),e.dispatch("updateLexState",t).then((function(){return y.a.resolve(t)}))})).catch((function(t){throw e.commit("setIsLexProcessing",!1),t}))},lexPostContent:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;e.commit("setIsLexProcessing",!0);var r=void 0;return e.dispatch("getCredentials").then((function(){return r=performance.now(),qt.postContent(t,e.state.lex.sessionAttributes,e.state.lex.acceptFormat,n)})).then((function(t){performance.now();return e.commit("setIsLexProcessing",!1),e.dispatch("updateLexState",t).then((function(){return e.dispatch("processLexContentResponse",t)})).then((function(e){return y.a.resolve(e)}))})).catch((function(t){throw e.commit("setIsLexProcessing",!1),t}))},processLexContentResponse:function(e,t){var n=t.audioStream,r=t.contentType,i=t.dialogState;return y.a.resolve().then((function(){if(!n||!n.length){var t="ReadyForFulfillment"===i?"All done":"There was an error";return e.dispatch("pollyGetBlob",t)}return y.a.resolve(new Blob([n],{type:r}))}))},updateLexState:function(e,t){var n={dialogState:"",inputTranscript:"",intentName:"",message:"",responseCard:null,sessionAttributes:{},slotToElicit:"",slots:{}};if("sessionAttributes"in t&&"appContext"in t.sessionAttributes)try{var r=JSON.parse(t.sessionAttributes.appContext);"responseCard"in r&&(n.responseCard=r.responseCard)}catch(e){var i=new Error("error parsing appContext in sessionAttributes: "+e);return y.a.reject(i)}return e.commit("updateLexState",p()({},n,t)),e.state.isRunningEmbedded&&e.dispatch("sendMessageToParentWindow",{event:"updateLexState",state:e.state.lex}),y.a.resolve()},pushMessage:function(e,t){e.commit("pushMessage",t)},pushErrorMessage:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Failed";e.commit("pushMessage",{type:"bot",text:t,dialogState:n})},getCredentialsFromParent:function(e){var t=Ut&&Ut.expireTime?Ut.expireTime:0;return new Date(t)>Date.now()?y.a.resolve(Ut):e.dispatch("sendMessageToParentWindow",{event:"getCredentials"}).then((function(e){if("resolve"===e.event&&"getCredentials"===e.type)return y.a.resolve(e.data);var t=new Error("invalid credential event from parent");return y.a.reject(t)})).then((function(e){var t=e.data.Credentials,n=t.AccessKeyId,r=t.SecretKey,i=t.SessionToken,o=e.data.IdentityId;return Ut={accessKeyId:n,secretAccessKey:r,sessionToken:i,identityId:o,expired:!1,getPromise:function(){return y.a.resolve(Ut)}}}))},getCredentials:function(e){return"parentWindow"===e.state.awsCreds.provider?e.dispatch("getCredentialsFromParent"):Ut.getPromise().then((function(){return Ut}))},toggleIsUiMinimized:function(e){return e.commit("toggleIsUiMinimized"),e.dispatch("sendMessageToParentWindow",{event:"toggleMinimizeUi"})},sendMessageToParentWindow:function(e,t){if(!e.state.isRunningEmbedded){var n="sendMessage called when not running embedded";return y.a.reject(n)}return new y.a(function(n,r){var i=new MessageChannel;i.port1.onmessage=function(e){if(i.port1.close(),i.port2.close(),"resolve"===e.data.event)n(e.data);else{var t="error in sendMessageToParentWindow: "+e.data.error;r(new Error(t))}},window.parent.postMessage(t,e.state.config.ui.parentOrigin,[i.port2])})}},Gt={strict:!1,state:yt,getters:_t,mutations:wt,actions:Wt};n.d(t,"Plugin",(function(){return Yt})),n.d(t,"Store",(function(){return Xt})),n.d(t,"Loader",(function(){return Zt}));var Vt={name:"lex-web-ui",template:'<lex-web v-on="$listeners"></lex-web>',components:{LexWeb:it}},Qt={template:"<p>Loading. Please wait...</p>"},Jt={template:"<p>An error ocurred...</p>"},Kt=function(e){var t=e.component,n=void 0===t?y.a.resolve(Vt):t,r=e.loading,i=void 0===r?Qt:r,o=e.error,s=void 0===o?Jt:o,a=e.delay,u=void 0===a?200:a,c=e.timeout;return{component:n,loading:i,error:s,delay:u,timeout:void 0===c?1e4:c}},Yt={install:function(e,t){var n=t.name,r=void 0===n?"$lexWebUi":n,i=t.componentName,o=void 0===i?"lex-web-ui":i,s=t.awsConfig,a=t.lexRuntimeClient,u=t.pollyClient,c=t.component,l=void 0===c?Kt:c,f=t.config,d=void 0===f?bt:f,p={config:d,awsConfig:s,lexRuntimeClient:a,pollyClient:u};m()(e.prototype,r,{value:p}),e.component(o,l)}},Xt=Gt,Zt=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};g()(this,e);var n=f(bt,t),r=window.Vue?window.Vue:w.a;if(!r)throw new Error("unable to find Vue");var i=window.Vuex?window.Vuex:A.a;if(!i)throw new Error("unable to find Vuex");var o=window.AWS&&window.AWS.Config?window.AWS.Config:S.Config,s=window.AWS&&window.AWS.CognitoIdentityCredentials?window.AWS.CognitoIdentityCredentials:S.CognitoIdentityCredentials,a=window.AWS&&window.AWS.Polly?window.AWS.Polly:C.a,u=window.AWS&&window.AWS.LexRuntime?window.AWS.LexRuntime:k.a;if(!(o&&s&&a&&u))throw new Error("unable to find AWS SDK");var c=new s({IdentityPoolId:n.cognito.poolId},{region:n.region||"us-east-1"}),l=new o({region:n.region||"us-east-1",credentials:c}),d=new u(l),h=void 0===n.recorder||n.recorder&&!1!==n.recorder.enable?new a(l):null;this.store=new i.Store(p()({},Gt)),r.use(Yt,{config:n,awsConfig:l,lexRuntimeClient:d,pollyClient:h})}}),(function(e,t,n){n(67),e.exports=n(0).Object.assign}),(function(e,t,n){var r=n(3);r(r.S+r.F,"Object",{assign:n(68)})}),(function(e,t,n){"use strict";var r=n(18),i=n(36),o=n(23),s=n(24),a=n(48),u=Object.assign;e.exports=!u||n(11)((function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=u({},e)[n]||Object.keys(u({},t)).join("")!=r}))?function(e,t){for(var n=s(e),u=arguments.length,c=1,l=i.f,f=o.f;u>c;)for(var d,p=a(arguments[c++]),h=l?r(p).concat(l(p)):r(p),g=h.length,v=0;g>v;)f.call(p,d=h[v++])&&(n[d]=p[d]);return n}:u}),(function(e,t,n){var r=n(12),i=n(31),o=n(70);e.exports=function(e){return function(t,n,s){var a,u=r(t),c=i(u.length),l=o(s,c);if(e&&n!=n){for(;c>l;)if((a=u[l++])!=a)return!0}else for(;c>l;l++)if((e||l in u)&&u[l]===n)return e||l||0;return!e&&-1}}}),(function(e,t,n){var r=n(32),i=Math.max,o=Math.min;e.exports=function(e,t){return e=r(e),e<0?i(e+t,0):o(e,t)}}),(function(e,t,n){n(72);var r=n(0).Object;e.exports=function(e,t,n){return r.defineProperty(e,t,n)}}),(function(e,t,n){var r=n(3);r(r.S+r.F*!n(7),"Object",{defineProperty:n(4).f})}),(function(e,t,n){n(49),n(20),n(27),n(81),n(88),n(89),e.exports=n(0).Promise}),(function(e,t,n){var r=n(32),i=n(30);e.exports=function(e){return function(t,n){var o,s,a=String(i(t)),u=r(n),c=a.length;return u<0||u>=c?e?"":void 0:(o=a.charCodeAt(u),o<55296||o>56319||u+1===c||(s=a.charCodeAt(u+1))<56320||s>57343?e?a.charAt(u):o:e?a.slice(u,u+2):s-56320+(o-55296<<10)+65536)}}}),(function(e,t,n){"use strict";var r=n(52),i=n(17),o=n(26),s={};n(8)(s,n(1)("iterator"),(function(){return this})),e.exports=function(e,t,n){e.prototype=r(s,{next:i(1,n)}),o(e,t+" Iterator")}}),(function(e,t,n){var r=n(4),i=n(5),o=n(18);e.exports=n(7)?Object.defineProperties:function(e,t){i(e);for(var n,s=o(t),a=s.length,u=0;a>u;)r.f(e,n=s[u++],t[n]);return e}}),(function(e,t,n){var r=n(10),i=n(24),o=n(33)("IE_PROTO"),s=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?s:null}}),(function(e,t,n){"use strict";var r=n(79),i=n(80),o=n(14),s=n(12);e.exports=n(50)(Array,"Array",(function(e,t){this._t=s(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):"keys"==t?i(0,n):"values"==t?i(0,e[n]):i(0,[n,e[n]])}),"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")}),(function(e,t){e.exports=function(){}}),(function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}}),(function(e,t,n){"use strict";var r,i,o,s,a=n(25),u=n(2),c=n(16),l=n(39),f=n(3),d=n(9),p=n(21),h=n(82),g=n(83),v=n(56),m=n(57).set,b=n(85)(),y=n(41),_=n(58),w=n(59),x=u.TypeError,A=u.process,S=u.Promise,M="process"==l(A),k=function(){},T=i=y.f,C=!!(function(){try{var e=S.resolve(1),t=(e.constructor={})[n(1)("species")]=function(e){e(k,k)};return(M||"function"==typeof PromiseRejectionEvent)&&e.then(k)instanceof t}catch(e){}})(),I=function(e){var t;return!(!d(e)||"function"!=typeof(t=e.then))&&t},E=function(e,t){if(!e._n){e._n=!0;var n=e._c;b((function(){for(var r=e._v,i=1==e._s,o=0;n.length>o;)!(function(t){var n,o,s=i?t.ok:t.fail,a=t.resolve,u=t.reject,c=t.domain;try{s?(i||(2==e._h&&O(e),e._h=1),!0===s?n=r:(c&&c.enter(),n=s(r),c&&c.exit()),n===t.promise?u(x("Promise-chain cycle")):(o=I(n))?o.call(n,a,u):a(n)):u(r)}catch(e){u(e)}})(n[o++]);e._c=[],e._n=!1,t&&!e._h&&P(e)}))}},P=function(e){m.call(u,(function(){var t,n,r,i=e._v,o=R(e);if(o&&(t=_((function(){M?A.emit("unhandledRejection",i,e):(n=u.onunhandledrejection)?n({promise:e,reason:i}):(r=u.console)&&r.error&&r.error("Unhandled promise rejection",i)})),e._h=M||R(e)?2:1),e._a=void 0,o&&t.e)throw t.v}))},R=function(e){return 1!==e._h&&0===(e._a||e._c).length},O=function(e){m.call(u,(function(){var t;M?A.emit("rejectionHandled",e):(t=u.onrejectionhandled)&&t({promise:e,reason:e._v})}))},B=function(e){var t=this;t._d||(t._d=!0,t=t._w||t,t._v=e,t._s=2,t._a||(t._a=t._c.slice()),E(t,!0))},L=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw x("Promise can't be resolved itself");(t=I(e))?b((function(){var r={_w:n,_d:!1};try{t.call(e,c(L,r,1),c(B,r,1))}catch(e){B.call(r,e)}})):(n._v=e,n._s=1,E(n,!1))}catch(e){B.call({_w:n,_d:!1},e)}}};C||(S=function(e){h(this,S,"Promise","_h"),p(e),r.call(this);try{e(c(L,this,1),c(B,this,1))}catch(e){B.call(this,e)}},r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},r.prototype=n(86)(S.prototype,{then:function(e,t){var n=T(v(this,S));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=M?A.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&E(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new r;this.promise=e,this.resolve=c(L,e,1),this.reject=c(B,e,1)},y.f=T=function(e){return e===S||e===s?new o(e):i(e)}),f(f.G+f.W+f.F*!C,{Promise:S}),n(26)(S,"Promise"),n(87)("Promise"),s=n(0).Promise,f(f.S+f.F*!C,"Promise",{reject:function(e){var t=T(this);return(0,t.reject)(e),t.promise}}),f(f.S+f.F*(a||!C),"Promise",{resolve:function(e){return w(a&&this===s?S:this,e)}}),f(f.S+f.F*!(C&&n(60)((function(e){S.all(e).catch(k)}))),"Promise",{all:function(e){var t=this,n=T(t),r=n.resolve,i=n.reject,o=_((function(){var n=[],o=0,s=1;g(e,!1,(function(e){var a=o++,u=!1;n.push(void 0),s++,t.resolve(e).then((function(e){u||(u=!0,n[a]=e,--s||r(n))}),i)})),--s||r(n)}));return o.e&&i(o.v),n.promise},race:function(e){var t=this,n=T(t),r=n.reject,i=_((function(){g(e,!1,(function(e){t.resolve(e).then(n.resolve,r)}))}));return i.e&&r(i.v),n.promise}})}),(function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}}),(function(e,t,n){var r=n(16),i=n(54),o=n(55),s=n(5),a=n(31),u=n(40),c={},l={},t=e.exports=function(e,t,n,f,d){var p,h,g,v,m=d?function(){return e}:u(e),b=r(n,f,t?2:1),y=0;if("function"!=typeof m)throw TypeError(e+" is not iterable!");if(o(m)){for(p=a(e.length);p>y;y++)if((v=t?b(s(h=e[y])[0],h[1]):b(e[y]))===c||v===l)return v}else for(g=m.call(e);!(h=g.next()).done;)if((v=i(g,b,h.value,t))===c||v===l)return v};t.BREAK=c,t.RETURN=l}),(function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}}),(function(e,t,n){var r=n(2),i=n(57).set,o=r.MutationObserver||r.WebKitMutationObserver,s=r.process,a=r.Promise,u="process"==n(19)(s);e.exports=function(){var e,t,n,c=function(){var r,i;for(u&&(r=s.domain)&&r.exit();e;){i=e.fn,e=e.next;try{i()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(u)n=function(){s.nextTick(c)};else if(!o||r.navigator&&r.navigator.standalone)if(a&&a.resolve){var l=a.resolve();n=function(){l.then(c)}}else n=function(){i.call(r,c)};else{var f=!0,d=document.createTextNode("");new o(c).observe(d,{characterData:!0}),n=function(){d.data=f=!f}}return function(r){var i={fn:r,next:void 0};t&&(t.next=i),e||(e=i,n()),t=i}}}),(function(e,t,n){var r=n(8);e.exports=function(e,t,n){for(var i in t)n&&e[i]?e[i]=t[i]:r(e,i,t[i]);return e}}),(function(e,t,n){"use strict";var r=n(2),i=n(0),o=n(4),s=n(7),a=n(1)("species");e.exports=function(e){var t="function"==typeof i[e]?i[e]:r[e];s&&t&&!t[a]&&o.f(t,a,{configurable:!0,get:function(){return this}})}}),(function(e,t,n){"use strict";var r=n(3),i=n(0),o=n(2),s=n(56),a=n(59);r(r.P+r.R,"Promise",{finally:function(e){var t=s(this,i.Promise||o.Promise),n="function"==typeof e;return this.then(n?function(n){return a(t,e()).then((function(){return n}))}:e,n?function(n){return a(t,e()).then((function(){throw n}))}:e)}})}),(function(e,t,n){"use strict";var r=n(3),i=n(41),o=n(58);r(r.S,"Promise",{try:function(e){var t=i.f(this),n=o(e);return(n.e?t.reject:t.resolve)(n.v),t.promise}})}),(function(t,n){t.exports=e}),(function(e,n){e.exports=t}),(function(e,t){e.exports=n}),(function(e,t){e.exports=r}),(function(e,t){e.exports=i}),(function(e,t){}),(function(e,t,n){n(97),e.exports=n(0).Object.keys}),(function(e,t,n){var r=n(24),i=n(18);n(98)("keys",(function(){return function(e){return i(r(e))}}))}),(function(e,t,n){var r=n(3),i=n(0),o=n(11);e.exports=function(e,t){var n=(i.Object||{})[e]||Object[e],s={};s[e]=t(n),r(r.S+r.F*o((function(){n(1)})),"Object",s)}}),(function(e,t){}),(function(e,t){}),(function(e,t){}),(function(e,t,n){t.markdown=n(103),t.parse=t.markdown.toHTML}),(function(e,t,n){!(function(e){function t(){return"Markdown.mk_block( "+uneval(this.toString())+", "+uneval(this.trailing)+", "+uneval(this.lineNumber)+" )"}function r(){var e=n(104);return"Markdown.mk_block( "+e.inspect(this.toString())+", "+e.inspect(this.trailing)+", "+e.inspect(this.lineNumber)+" )"}function i(e){for(var t=0,n=-1;-1!==(n=e.indexOf("\n",n+1));)t++;return t}function o(e,t){function n(e){this.len_after=e,this.name="close_"+t}var r=e+"_state",i="strong"==e?"em_state":"strong_state";return function(o,s){if(this[r][0]==t)return this[r].shift(),[o.length,new n(o.length-t.length)];var a=this[i].slice(),u=this[r].slice();this[r].unshift(t);var c=this.processInline(o.substr(t.length)),l=c[c.length-1];this[r].shift();if(l instanceof n){c.pop();return[o.length-l.len_after,[e].concat(c)]}return this[i]=a,this[r]=u,[t.length,t]}}function s(e){for(var t=e.split(""),n=[""],r=!1;t.length;){var i=t.shift();switch(i){case" ":r?n[n.length-1]+=i:n.push("");break;case"'":case'"':r=!r;break;case"\\":i=t.shift();default:n[n.length-1]+=i}}return n}function u(e){return m(e)&&e.length>1&&"object"==typeof e[1]&&!m(e[1])?e[1]:void 0}function c(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function l(e){if("string"==typeof e)return c(e);var t=e.shift(),n={},r=[];for(!e.length||"object"!=typeof e[0]||e[0]instanceof Array||(n=e.shift());e.length;)r.push(l(e.shift()));var i="";for(var o in n)i+=" "+o+'="'+c(n[o])+'"';return"img"==t||"br"==t||"hr"==t?"<"+t+i+"/>":"<"+t+i+">"+r.join("")+"</"+t+">"}function f(e,t,n){var r;n=n||{};var i=e.slice(0);"function"==typeof n.preprocessTreeNode&&(i=n.preprocessTreeNode(i,t));var o=u(i);if(o){i[1]={};for(r in o)i[1][r]=o[r];o=i[1]}if("string"==typeof i)return i;switch(i[0]){case"header":i[0]="h"+i[1].level,delete i[1].level;break;case"bulletlist":i[0]="ul";break;case"numberlist":i[0]="ol";break;case"listitem":i[0]="li";break;case"para":i[0]="p";break;case"markdown":i[0]="html",o&&delete o.references;break;case"code_block":i[0]="pre",r=o?2:1;var s=["code"];s.push.apply(s,i.splice(r,i.length-r)),i[r]=s;break;case"inlinecode":i[0]="code";break;case"img":i[1].src=i[1].href,delete i[1].href;break;case"linebreak":i[0]="br";break;case"link":i[0]="a";break;case"link_ref":i[0]="a";var a=t[o.ref];if(!a)return o.original;delete o.ref,o.href=a.href,a.title&&(o.title=a.title),delete o.original;break;case"img_ref":i[0]="img";var a=t[o.ref];if(!a)return o.original;delete o.ref,o.src=a.href,a.title&&(o.title=a.title),delete o.original}if(r=1,o){for(var c in i[1]){r=2;break}1===r&&i.splice(r,1)}for(;r<i.length;++r)i[r]=f(i[r],t,n);return i}function d(e){for(var t=u(e)?2:1;t<e.length;)"string"==typeof e[t]?t+1<e.length&&"string"==typeof e[t+1]?e[t]+=e.splice(t+1,1)[0]:++t:(d(e[t]),++t)}var h=e.Markdown=function(e){switch(typeof e){case"undefined":this.dialect=h.dialects.Gruber;break;case"object":this.dialect=e;break;default:if(!(e in h.dialects))throw new Error("Unknown Markdown dialect '"+String(e)+"'");this.dialect=h.dialects[e]}this.em_state=[],this.strong_state=[],this.debug_indent=""};e.parse=function(e,t){return new h(t).toTree(e)},e.toHTML=function(t,n,r){var i=e.toHTMLTree(t,n,r);return e.renderJsonML(i)},e.toHTMLTree=function(e,t,n){"string"==typeof e&&(e=this.parse(e,t));var r=u(e),i={};r&&r.references&&(i=r.references);var o=f(e,i,n);return d(o),o};var g=h.mk_block=function(e,n,i){1==arguments.length&&(n="\n\n");var o=new String(e);return o.trailing=n,o.inspect=r,o.toSource=t,void 0!=i&&(o.lineNumber=i),o};h.prototype.split_blocks=function(e,t){e=e.replace(/(\r\n|\n|\r)/g,"\n");var n,r=/([\s\S]+?)($|\n#|\n(?:\s*\n|$)+)/g,o=[],s=1;for(null!=(n=/^(\s*\n)/.exec(e))&&(s+=i(n[0]),r.lastIndex=n[0].length);null!==(n=r.exec(e));)"\n#"==n[2]&&(n[2]="\n",r.lastIndex--),o.push(g(n[1],n[2],s)),s+=i(n[0]);return o},h.prototype.processBlock=function(e,t){var n=this.dialect.block,r=n.__order__;if("__call__"in n)return n.__call__.call(this,e,t);for(var i=0;i<r.length;i++){var o=n[r[i]].call(this,e,t);if(o)return(!m(o)||o.length>0&&!m(o[0]))&&this.debug(r[i],"didn't return a proper array"),o}return[]},h.prototype.processInline=function(e){return this.dialect.inline.__call__.call(this,String(e))},h.prototype.toTree=function(e,t){var n=e instanceof Array?e:this.split_blocks(e),r=this.tree;try{for(this.tree=t||this.tree||["markdown"];n.length;){var i=this.processBlock(n.shift(),n);i.length&&this.tree.push.apply(this.tree,i)}return this.tree}finally{t&&(this.tree=r)}},h.prototype.debug=function(){var e=Array.prototype.slice.call(arguments);e.unshift(this.debug_indent),"undefined"!=typeof print&&print.apply(print,e),"undefined"!=typeof console&&console.log},h.prototype.loop_re_over_block=function(e,t,n){for(var r,i=t.valueOf();i.length&&null!=(r=e.exec(i));)i=i.substr(r[0].length),n.call(this,r);return i},h.dialects={},h.dialects.Gruber={block:{atxHeader:function(e,t){var n=e.match(/^(#{1,6})\s*(.*?)\s*#*\s*(?:\n|$)/);if(n){var r=["header",{level:n[1].length}];return Array.prototype.push.apply(r,this.processInline(n[2])),n[0].length<e.length&&t.unshift(g(e.substr(n[0].length),e.trailing,e.lineNumber+2)),[r]}},setextHeader:function(e,t){var n=e.match(/^(.*)\n([-=])\2\2+(?:\n|$)/);if(n){var r="="===n[2]?1:2,i=["header",{level:r},n[1]];return n[0].length<e.length&&t.unshift(g(e.substr(n[0].length),e.trailing,e.lineNumber+2)),[i]}},code:function(e,t){var n=[],r=/^(?: {0,3}\t| {4})(.*)\n?/;if(e.match(r)){e:for(;;){var i=this.loop_re_over_block(r,e.valueOf(),(function(e){n.push(e[1])}));if(i.length){t.unshift(g(i,e.trailing));break e}if(!t.length)break e;if(!t[0].match(r))break e;n.push(e.trailing.replace(/[^\n]/g,"").substring(2)),e=t.shift()}return[["code_block",n.join("\n")]]}},horizRule:function(e,t){var n=e.match(/^(?:([\s\S]*?)\n)?[ \t]*([-_*])(?:[ \t]*\2){2,}[ \t]*(?:\n([\s\S]*))?$/);if(n){var r=[["hr"]];return n[1]&&r.unshift.apply(r,this.processBlock(n[1],[])),n[3]&&t.unshift(g(n[3])),r}},lists:(function(){function e(e){return new RegExp("(?:^("+u+"{0,"+e+"} {0,3})("+o+")\\s+)|(^"+u+"{0,"+(e-1)+"}[ ]{0,4})")}function t(e){return e.replace(/ {0,3}\t/g,"    ")}function n(e,t,n,r){if(t)return void e.push(["para"].concat(n));var i=e[e.length-1]instanceof Array&&"para"==e[e.length-1][0]?e[e.length-1]:e;r&&e.length>1&&n.unshift(r);for(var o=0;o<n.length;o++){var s=n[o];"string"==typeof s&&i.length>1&&"string"==typeof i[i.length-1]?i[i.length-1]+=s:i.push(s)}}function r(e,t){for(var n=new RegExp("^("+u+"{"+e+"}.*?\\n?)*$"),r=new RegExp("^"+u+"{"+e+"}","gm"),i=[];t.length>0&&n.exec(t[0]);){var o=t.shift(),s=o.replace(r,"");i.push(g(s,o.trailing,o.lineNumber))}return i}function i(e,t,n){var r=e.list,i=r[r.length-1];if(!(i[1]instanceof Array&&"para"==i[1][0]))if(t+1==n.length)i.push(["para"].concat(i.splice(1,i.length-1)));else{var o=i.pop();i.push(["para"].concat(i.splice(1,i.length-1)),o)}}var o="[*+-]|\\d+\\.",s=/[*+-]/,a=new RegExp("^( {0,3})("+o+")[ \t]+"),u="(?: {0,3}\\t| {4})";return function(o,u){function c(e){var t=s.exec(e[2])?["bulletlist"]:["numberlist"];return p.push({list:t,indent:e[1]}),t}var l=o.match(a);if(l){for(var f,d,p=[],h=c(l),g=!1,m=[p[0].list];;){for(var b=o.split(/(?=\n)/),y="",_=0;_<b.length;_++){var w="",x=b[_].replace(/^\n/,(function(e){return w=e,""})),A=e(p.length);if(l=x.match(A),void 0!==l[1]){y.length&&(n(f,g,this.processInline(y),w),g=!1,y=""),l[1]=t(l[1]);var S=Math.floor(l[1].length/4)+1;if(S>p.length)h=c(l),f.push(h),f=h[1]=["listitem"];else{var M=!1;for(d=0;d<p.length;d++)if(p[d].indent==l[1]){h=p[d].list,p.splice(d+1,p.length-(d+1)),M=!0;break}M||(S++,S<=p.length?(p.splice(S,p.length-S),h=p[S-1].list):(h=c(l),f.push(h))),f=["listitem"],h.push(f)}w=""}x.length>l[0].length&&(y+=w+x.substr(l[0].length))}y.length&&(n(f,g,this.processInline(y),w),g=!1,y="");var k=r(p.length,u);k.length>0&&(v(p,i,this),f.push.apply(f,this.toTree(k,[])));var T=u[0]&&u[0].valueOf()||"";if(!T.match(a)&&!T.match(/^ /))break;o=u.shift();var C=this.dialect.block.horizRule(o,u);if(C){m.push.apply(m,C);break}v(p,i,this),g=!0}return m}}})(),blockquote:function(e,t){if(e.match(/^>/m)){var n=[];if(">"!=e[0]){for(var r=e.split(/\n/),i=[],o=e.lineNumber;r.length&&">"!=r[0][0];)i.push(r.shift()),o++;var s=g(i.join("\n"),"\n",e.lineNumber);n.push.apply(n,this.processBlock(s,[])),e=g(r.join("\n"),e.trailing,o)}for(;t.length&&">"==t[0][0];){var a=t.shift();e=g(e+e.trailing+a,a.trailing,e.lineNumber)}var c=e.replace(/^> ?/gm,""),l=(this.tree,this.toTree(c,["blockquote"])),f=u(l);return f&&f.references&&(delete f.references,b(f)&&l.splice(1,1)),n.push(l),n}},referenceDefn:function(e,t){var n=/^\s*\[(.*?)\]:\s*(\S+)(?:\s+(?:(['"])(.*?)\3|\((.*?)\)))?\n?/;if(e.match(n)){u(this.tree)||this.tree.splice(1,0,{});var r=u(this.tree);void 0===r.references&&(r.references={});var i=this.loop_re_over_block(n,e,(function(e){e[2]&&"<"==e[2][0]&&">"==e[2][e[2].length-1]&&(e[2]=e[2].substring(1,e[2].length-1));var t=r.references[e[1].toLowerCase()]={href:e[2]};void 0!==e[4]?t.title=e[4]:void 0!==e[5]&&(t.title=e[5])}));return i.length&&t.unshift(g(i,e.trailing)),[]}},para:function(e,t){return[["para"].concat(this.processInline(e))]}}},h.dialects.Gruber.inline={__oneElement__:function(e,t,n){var r,i;if(t=t||this.dialect.inline.__patterns__,!(r=new RegExp("([\\s\\S]*?)("+(t.source||t)+")").exec(e)))return[e.length,e];if(r[1])return[r[1].length,r[1]];var i;return r[2]in this.dialect.inline&&(i=this.dialect.inline[r[2]].call(this,e.substr(r.index),r,n||[])),i=i||[r[2].length,r[2]]},__call__:function(e,t){function n(e){"string"==typeof e&&"string"==typeof i[i.length-1]?i[i.length-1]+=e:i.push(e)}for(var r,i=[];e.length>0;)r=this.dialect.inline.__oneElement__.call(this,e,t,i),e=e.substr(r.shift()),v(r,n);return i},"]":function(){},"}":function(){},__escape__:/^\\[\\`\*_{}\[\]()#\+.!\-]/,"\\":function(e){return this.dialect.inline.__escape__.exec(e)?[2,e.charAt(1)]:[1,"\\"]},"![":function(e){var t=e.match(/^!\[(.*?)\][ \t]*\([ \t]*([^")]*?)(?:[ \t]+(["'])(.*?)\3)?[ \t]*\)/);if(t){t[2]&&"<"==t[2][0]&&">"==t[2][t[2].length-1]&&(t[2]=t[2].substring(1,t[2].length-1)),t[2]=this.dialect.inline.__call__.call(this,t[2],/\\/)[0];var n={alt:t[1],href:t[2]||""};return void 0!==t[4]&&(n.title=t[4]),[t[0].length,["img",n]]}return t=e.match(/^!\[(.*?)\][ \t]*\[(.*?)\]/),t?[t[0].length,["img_ref",{alt:t[1],ref:t[2].toLowerCase(),original:t[0]}]]:[2,"!["]},"[":function(e){var t=String(e),n=h.DialectHelpers.inline_until_char.call(this,e.substr(1),"]");if(!n)return[1,"["];var r,i,o=1+n[0],s=n[1];e=e.substr(o);var a=e.match(/^\s*\([ \t]*([^"']*)(?:[ \t]+(["'])(.*?)\2)?[ \t]*\)/);if(a){var u=a[1];if(o+=a[0].length,u&&"<"==u[0]&&">"==u[u.length-1]&&(u=u.substring(1,u.length-1)),!a[3])for(var c=1,l=0;l<u.length;l++)switch(u[l]){case"(":c++;break;case")":0==--c&&(o-=u.length-l,u=u.substring(0,l))}return u=this.dialect.inline.__call__.call(this,u,/\\/)[0],i={href:u||""},void 0!==a[3]&&(i.title=a[3]),r=["link",i].concat(s),[o,r]}return a=e.match(/^\s*\[(.*?)\]/),a?(o+=a[0].length,i={ref:(a[1]||String(s)).toLowerCase(),original:t.substr(0,o)},r=["link_ref",i].concat(s),[o,r]):1==s.length&&"string"==typeof s[0]?(i={ref:s[0].toLowerCase(),original:t.substr(0,o)},r=["link_ref",i,s[0]],[o,r]):[1,"["]},"<":function(e){var t;return null!=(t=e.match(/^<(?:((https?|ftp|mailto):[^>]+)|(.*?@.*?\.[a-zA-Z]+))>/))?t[3]?[t[0].length,["link",{href:"mailto:"+t[3]},t[3]]]:"mailto"==t[2]?[t[0].length,["link",{href:t[1]},t[1].substr("mailto:".length)]]:[t[0].length,["link",{href:t[1]},t[1]]]:[1,"<"]},"`":function(e){var t=e.match(/(`+)(([\s\S]*?)\1)/);return t&&t[2]?[t[1].length+t[2].length,["inlinecode",t[3]]]:[1,"`"]},"  \n":function(e){return[3,["linebreak"]]}},h.dialects.Gruber.inline["**"]=o("strong","**"),h.dialects.Gruber.inline.__=o("strong","__"),h.dialects.Gruber.inline["*"]=o("em","*"),h.dialects.Gruber.inline._=o("em","_"),h.buildBlockOrder=function(e){var t=[];for(var n in e)"__order__"!=n&&"__call__"!=n&&t.push(n);e.__order__=t},h.buildInlinePatterns=function(e){var t=[];for(var n in e)if(!n.match(/^__.*__$/)){var r=n.replace(/([\\.*+?|()\[\]{}])/g,"\\$1").replace(/\n/,"\\n");t.push(1==n.length?r:"(?:"+r+")")}t=t.join("|"),e.__patterns__=t;var i=e.__call__;e.__call__=function(e,n){return void 0!=n?i.call(this,e,n):i.call(this,e,t)}},h.DialectHelpers={},h.DialectHelpers.inline_until_char=function(e,t){for(var n=0,r=[];;){if(e.charAt(n)==t)return n++,[n,r];if(n>=e.length)return null;var i=this.dialect.inline.__oneElement__.call(this,e.substr(n));n+=i[0],r.push.apply(r,i.slice(1))}},h.subclassDialect=function(e){function t(){}function n(){}return t.prototype=e.block,n.prototype=e.inline,{block:new t,inline:new n}},h.buildBlockOrder(h.dialects.Gruber.block),h.buildInlinePatterns(h.dialects.Gruber.inline),h.dialects.Maruku=h.subclassDialect(h.dialects.Gruber),h.dialects.Maruku.processMetaHash=function(e){for(var t=s(e),n={},r=0;r<t.length;++r)if(/^#/.test(t[r]))n.id=t[r].substring(1);else if(/^\./.test(t[r]))n.class?n.class=n.class+t[r].replace(/./," "):n.class=t[r].substring(1);else if(/\=/.test(t[r])){var i=t[r].split(/\=/);n[i[0]]=i[1]}return n},h.dialects.Maruku.block.document_meta=function(e,t){if(!(e.lineNumber>1)&&e.match(/^(?:\w+:.*\n)*\w+:.*$/)){u(this.tree)||this.tree.splice(1,0,{});var n=e.split(/\n/);for(p in n){var r=n[p].match(/(\w+):\s*(.*)$/),i=r[1].toLowerCase(),o=r[2];this.tree[1][i]=o}return[]}},h.dialects.Maruku.block.block_meta=function(e,t){var n=e.match(/(^|\n) {0,3}\{:\s*((?:\\\}|[^\}])*)\s*\}$/);if(n){var r,i=this.dialect.processMetaHash(n[2]);if(""===n[1]){var o=this.tree[this.tree.length-1];if(r=u(o),"string"==typeof o)return;r||(r={},o.splice(1,0,r));for(a in i)r[a]=i[a];return[]}var s=e.replace(/\n.*$/,""),c=this.processBlock(s,[]);r=u(c[0]),r||(r={},c[0].splice(1,0,r));for(a in i)r[a]=i[a];return c}},h.dialects.Maruku.block.definition_list=function(e,t){var n,r,i=/^((?:[^\s:].*\n)+):\s+([\s\S]+)$/,o=["dl"];if(r=e.match(i)){for(var s=[e];t.length&&i.exec(t[0]);)s.push(t.shift());for(var a=0;a<s.length;++a){var r=s[a].match(i),u=r[1].replace(/\n$/,"").split(/\n/),c=r[2].split(/\n:\s+/);for(n=0;n<u.length;++n)o.push(["dt",u[n]]);for(n=0;n<c.length;++n)o.push(["dd"].concat(this.processInline(c[n].replace(/(\n)\s+/,"$1"))))}return[o]}},h.dialects.Maruku.block.table=function(e,t){var n,r,i=function(e,t){t=t||"\\s",t.match(/^[\\|\[\]{}?*.+^$]$/)&&(t="\\"+t);for(var n,r=[],i=new RegExp("^((?:\\\\.|[^\\\\"+t+"])*)"+t+"(.*)");n=e.match(i);)r.push(n[1]),e=n[2];return r.push(e),r},o=/^ {0,3}\|(.+)\n {0,3}\|\s*([\-:]+[\-| :]*)\n((?:\s*\|.*(?:\n|$))*)(?=\n|$)/,s=/^ {0,3}(\S(?:\\.|[^\\|])*\|.*)\n {0,3}([\-:]+\s*\|[\-| :]*)\n((?:(?:\\.|[^\\|])*\|.*(?:\n|$))*)(?=\n|$)/;if(r=e.match(o))r[3]=r[3].replace(/^\s*\|/gm,"");else if(!(r=e.match(s)))return;var a=["table",["thead",["tr"]],["tbody"]];r[2]=r[2].replace(/\|\s*$/,"").split("|");var u=[];for(v(r[2],(function(e){e.match(/^\s*-+:\s*$/)?u.push({align:"right"}):e.match(/^\s*:-+\s*$/)?u.push({align:"left"}):e.match(/^\s*:-+:\s*$/)?u.push({align:"center"}):u.push({})})),r[1]=i(r[1].replace(/\|\s*$/,""),"|"),n=0;n<r[1].length;n++)a[1][1].push(["th",u[n]||{}].concat(this.processInline(r[1][n].trim())));return v(r[3].replace(/\|\s*$/gm,"").split("\n"),(function(e){var t=["tr"];for(e=i(e,"|"),n=0;n<e.length;n++)t.push(["td",u[n]||{}].concat(this.processInline(e[n].trim())));a[2].push(t)}),this),[a]},h.dialects.Maruku.inline["{:"]=function(e,t,n){if(!n.length)return[2,"{:"];var r=n[n.length-1];if("string"==typeof r)return[2,"{:"];var i=e.match(/^\{:\s*((?:\\\}|[^\}])*)\s*\}/);if(!i)return[2,"{:"];var o=this.dialect.processMetaHash(i[1]),s=u(r);s||(s={},r.splice(1,0,s));for(var a in o)s[a]=o[a];return[i[0].length,""]},h.dialects.Maruku.inline.__escape__=/^\\[\\`\*_{}\[\]()#\+.!\-|:]/,h.buildBlockOrder(h.dialects.Maruku.block),h.buildInlinePatterns(h.dialects.Maruku.inline);var v,m=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)};v=Array.prototype.forEach?function(e,t,n){return e.forEach(t,n)}:function(e,t,n){for(var r=0;r<e.length;r++)t.call(n||e,e[r],r,e)};var b=function(e){for(var t in e)if(hasOwnProperty.call(e,t))return!1;return!0};e.renderJsonML=function(e,t){t=t||{},t.root=t.root||!1;var n=[];if(t.root)n.push(l(e));else for(e.shift(),!e.length||"object"!=typeof e[0]||e[0]instanceof Array||e.shift();e.length;)n.push(l(e.shift()));return n.join("\n\n")}})(function(){return t}())}),(function(e,t,n){(function(e,r){function i(e,n){var r={seen:[],stylize:s};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),g(n)?r.showHidden=n:n&&t._extend(r,n),w(r.showHidden)&&(r.showHidden=!1),w(r.depth)&&(r.depth=2),w(r.colors)&&(r.colors=!1),w(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=o),u(r,e,r.depth)}function o(e,t){var n=i.styles[t];return n?"["+i.colors[n][0]+"m"+e+"["+i.colors[n][1]+"m":e}function s(e,t){return e}function a(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}function u(e,n,r){if(e.customInspect&&n&&k(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,e);return y(i)||(i=u(e,i,r)),i}var o=c(e,n);if(o)return o;var s=Object.keys(n),g=a(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(n)),M(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return l(n);if(0===s.length){if(k(n)){var v=n.name?": "+n.name:"";return e.stylize("[Function"+v+"]","special")}if(x(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(S(n))return e.stylize(Date.prototype.toString.call(n),"date");if(M(n))return l(n)}var m="",b=!1,_=["{","}"];if(h(n)&&(b=!0,_=["[","]"]),k(n)){m=" [Function"+(n.name?": "+n.name:"")+"]"}if(x(n)&&(m=" "+RegExp.prototype.toString.call(n)),S(n)&&(m=" "+Date.prototype.toUTCString.call(n)),M(n)&&(m=" "+l(n)),0===s.length&&(!b||0==n.length))return _[0]+m+_[1];if(r<0)return x(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special");e.seen.push(n);var w;return w=b?f(e,n,r,g,s):s.map((function(t){return d(e,n,r,g,t,b)})),e.seen.pop(),p(w,m,_)}function c(e,t){if(w(t))return e.stylize("undefined","undefined");if(y(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return b(t)?e.stylize(""+t,"number"):g(t)?e.stylize(""+t,"boolean"):v(t)?e.stylize("null","null"):void 0}function l(e){return"["+Error.prototype.toString.call(e)+"]"}function f(e,t,n,r,i){for(var o=[],s=0,a=t.length;s<a;++s)I(t,String(s))?o.push(d(e,t,n,r,String(s),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(d(e,t,n,r,i,!0))})),o}function d(e,t,n,r,i,o){var s,a,c;if(c=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]},c.get?a=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(a=e.stylize("[Setter]","special")),I(r,i)||(s="["+i+"]"),a||(e.seen.indexOf(c.value)<0?(a=v(n)?u(e,c.value,null):u(e,c.value,n-1),a.indexOf("\n")>-1&&(a=o?a.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+a.split("\n").map((function(e){return"   "+e})).join("\n"))):a=e.stylize("[Circular]","special")),w(s)){if(o&&i.match(/^\d+$/))return a;s=JSON.stringify(""+i),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function p(e,t,n){var r=0;return e.reduce((function(e,t){return r++,t.indexOf("\n")>=0&&r++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function h(e){return Array.isArray(e)}function g(e){return"boolean"==typeof e}function v(e){return null===e}function m(e){return null==e}function b(e){return"number"==typeof e}function y(e){return"string"==typeof e}function _(e){return"symbol"==typeof e}function w(e){return void 0===e}function x(e){return A(e)&&"[object RegExp]"===C(e)}function A(e){return"object"==typeof e&&null!==e}function S(e){return A(e)&&"[object Date]"===C(e)}function M(e){return A(e)&&("[object Error]"===C(e)||e instanceof Error)}function k(e){return"function"==typeof e}function T(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e}function C(e){return Object.prototype.toString.call(e)}function I(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var E=/%[sdj%]/g;t.format=function(e){if(!y(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(i(arguments[n]));return t.join(" ")}for(var n=1,r=arguments,o=r.length,s=String(e).replace(E,(function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}})),a=r[n];n<o;a=r[++n])v(a)||!A(a)?s+=" "+a:s+=" "+i(a);return s},t.deprecate=function(n,i){function o(){if(!s){if(r.throwDeprecation)throw new Error(i);r.traceDeprecation,s=!0}return n.apply(this,arguments)}if(w(e.process))return function(){return t.deprecate(n,i).apply(this,arguments)};if(!0===r.noDeprecation)return n;var s=!1;return o};var P,R={};t.debuglog=function(e){if(w(P)&&(P=Object({NODE_ENV:"production",PACKAGE_VERSION:"0.14.0",DIST_BUILD:"true",PUBLIC_PATH:"/"}).NODE_DEBUG||""),e=e.toUpperCase(),!R[e])if(new RegExp("\\b"+e+"\\b","i").test(P)){r.pid;R[e]=function(){t.format.apply(t,arguments)}}else R[e]=function(){};return R[e]},t.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=h,t.isBoolean=g,t.isNull=v,t.isNullOrUndefined=m,t.isNumber=b,t.isString=y,t.isSymbol=_,t.isUndefined=w,t.isRegExp=x,t.isObject=A,t.isDate=S,t.isError=M,t.isFunction=k,t.isPrimitive=T,t.isBuffer=n(107);t.log=function(){},t.inherits=n(108),t._extend=function(e,t){if(!t||!A(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}).call(t,n(105),n(106))}),(function(e,t){var n;n=(function(){return this})();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n}),(function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(e){if(l===setTimeout)return setTimeout(e,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function o(e){if(f===clearTimeout)return clearTimeout(e);if((f===r||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{return f(e)}catch(t){try{return f.call(null,e)}catch(t){return f.call(this,e)}}}function s(){g&&p&&(g=!1,p.length?h=p.concat(h):v=-1,h.length&&a())}function a(){if(!g){var e=i(s);g=!0;for(var t=h.length;t;){for(p=h,h=[];++v<t;)p&&p[v].run();v=-1,t=h.length}p=null,g=!1,o(e)}}function u(e,t){this.fun=e,this.array=t}function c(){}var l,f,d=e.exports={};!(function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(e){l=n}try{f="function"==typeof clearTimeout?clearTimeout:r}catch(e){f=r}})();var p,h=[],g=!1,v=-1;d.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];h.push(new u(e,t)),1!==h.length||g||i(a)},u.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=c,d.addListener=c,d.once=c,d.off=c,d.removeListener=c,d.removeAllListeners=c,d.emit=c,d.prependListener=c,d.prependOnceListener=c,d.listeners=function(e){return[]},d.binding=function(e){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(e){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}}),(function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}}),(function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}),(function(e,t){}),(function(e,t){}),(function(e,t){}),(function(e,t){}),(function(e,t,n){e.exports={default:n(114),__esModule:!0}}),(function(e,t,n){n(20),n(27),e.exports=n(43).f("iterator")}),(function(e,t,n){e.exports={default:n(116),__esModule:!0}}),(function(e,t,n){n(117),n(49),n(123),n(124),e.exports=n(0).Symbol}),(function(e,t,n){"use strict";var r=n(2),i=n(10),o=n(7),s=n(3),a=n(51),u=n(118).KEY,c=n(11),l=n(34),f=n(26),d=n(22),p=n(1),h=n(43),g=n(44),v=n(119),m=n(120),b=n(5),y=n(9),_=n(12),w=n(29),x=n(17),A=n(52),S=n(121),M=n(122),k=n(4),T=n(18),C=M.f,I=k.f,E=S.f,P=r.Symbol,R=r.JSON,O=R&&R.stringify,B=p("_hidden"),L=p("toPrimitive"),j={}.propertyIsEnumerable,F=l("symbol-registry"),$=l("symbols"),D=l("op-symbols"),U=Object.prototype,N="function"==typeof P,q=r.QObject,z=!q||!q.prototype||!q.prototype.findChild,H=o&&c((function(){return 7!=A(I({},"a",{get:function(){return I(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=C(U,t);r&&delete U[t],I(e,t,n),r&&e!==U&&I(U,t,r)}:I,W=function(e){var t=$[e]=A(P.prototype);return t._k=e,t},G=N&&"symbol"==typeof P.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof P},V=function(e,t,n){return e===U&&V(D,t,n),b(e),t=w(t,!0),b(n),i($,t)?(n.enumerable?(i(e,B)&&e[B][t]&&(e[B][t]=!1),n=A(n,{enumerable:x(0,!1)})):(i(e,B)||I(e,B,x(1,{})),e[B][t]=!0),H(e,t,n)):I(e,t,n)},Q=function(e,t){b(e);for(var n,r=v(t=_(t)),i=0,o=r.length;o>i;)V(e,n=r[i++],t[n]);return e},J=function(e,t){return void 0===t?A(e):Q(A(e),t)},K=function(e){var t=j.call(this,e=w(e,!0));return!(this===U&&i($,e)&&!i(D,e))&&(!(t||!i(this,e)||!i($,e)||i(this,B)&&this[B][e])||t)},Y=function(e,t){if(e=_(e),t=w(t,!0),e!==U||!i($,t)||i(D,t)){var n=C(e,t);return!n||!i($,t)||i(e,B)&&e[B][t]||(n.enumerable=!0),n}},X=function(e){for(var t,n=E(_(e)),r=[],o=0;n.length>o;)i($,t=n[o++])||t==B||t==u||r.push(t);return r},Z=function(e){for(var t,n=e===U,r=E(n?D:_(e)),o=[],s=0;r.length>s;)!i($,t=r[s++])||n&&!i(U,t)||o.push($[t]);return o};N||(P=function(){if(this instanceof P)throw TypeError("Symbol is not a constructor!");var e=d(arguments.length>0?arguments[0]:void 0),t=function(n){this===U&&t.call(D,n),i(this,B)&&i(this[B],e)&&(this[B][e]=!1),H(this,e,x(1,n))};return o&&z&&H(U,e,{configurable:!0,set:t}),W(e)},a(P.prototype,"toString",(function(){return this._k})),M.f=Y,k.f=V,n(62).f=S.f=X,n(23).f=K,n(36).f=Z,o&&!n(25)&&a(U,"propertyIsEnumerable",K,!0),h.f=function(e){return W(p(e))}),s(s.G+s.W+s.F*!N,{Symbol:P});for(var ee="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),te=0;ee.length>te;)p(ee[te++]);for(var ne=T(p.store),re=0;ne.length>re;)g(ne[re++]);s(s.S+s.F*!N,"Symbol",{for:function(e){return i(F,e+="")?F[e]:F[e]=P(e)},keyFor:function(e){if(!G(e))throw TypeError(e+" is not a symbol!");for(var t in F)if(F[t]===e)return t},useSetter:function(){z=!0},useSimple:function(){z=!1}}),s(s.S+s.F*!N,"Object",{create:J,defineProperty:V,defineProperties:Q,getOwnPropertyDescriptor:Y,getOwnPropertyNames:X,getOwnPropertySymbols:Z}),R&&s(s.S+s.F*(!N||c((function(){var e=P();return"[null]"!=O([e])||"{}"!=O({a:e})||"{}"!=O(Object(e))}))),"JSON",{stringify:function(e){for(var t,n,r=[e],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=t=r[1],(y(t)||void 0!==e)&&!G(e))return m(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!G(t))return t}),r[1]=t,O.apply(R,r)}}),P.prototype[L]||n(8)(P.prototype,L,P.prototype.valueOf),f(P,"Symbol"),f(Math,"Math",!0),f(r.JSON,"JSON",!0)}),(function(e,t,n){var r=n(22)("meta"),i=n(9),o=n(10),s=n(4).f,a=0,u=Object.isExtensible||function(){return!0},c=!n(11)((function(){return u(Object.preventExtensions({}))})),l=function(e){s(e,r,{value:{i:"O"+ ++a,w:{}}})},f=function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,r)){if(!u(e))return"F";if(!t)return"E";l(e)}return e[r].i},d=function(e,t){if(!o(e,r)){if(!u(e))return!0;if(!t)return!1;l(e)}return e[r].w},p=function(e){return c&&h.NEED&&u(e)&&!o(e,r)&&l(e),e},h=e.exports={KEY:r,NEED:!1,fastKey:f,getWeak:d,onFreeze:p}}),(function(e,t,n){var r=n(18),i=n(36),o=n(23);e.exports=function(e){var t=r(e),n=i.f;if(n)for(var s,a=n(e),u=o.f,c=0;a.length>c;)u.call(e,s=a[c++])&&t.push(s);return t}}),(function(e,t,n){var r=n(19);e.exports=Array.isArray||function(e){return"Array"==r(e)}}),(function(e,t,n){var r=n(12),i=n(62).f,o={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],a=function(e){try{return i(e)}catch(e){return s.slice()}};e.exports.f=function(e){return s&&"[object Window]"==o.call(e)?a(e):i(r(e))}}),(function(e,t,n){var r=n(23),i=n(17),o=n(12),s=n(29),a=n(10),u=n(46),c=Object.getOwnPropertyDescriptor;t.f=n(7)?c:function(e,t){if(e=o(e),t=s(t,!0),u)try{return c(e,t)}catch(e){}if(a(e,t))return i(!r.f.call(e,t),e[t])}}),(function(e,t,n){n(44)("asyncIterator")}),(function(e,t,n){n(44)("observable")}),(function(e,t,n){"use strict";t.__esModule=!0;var r=n(38),i=(function(e){return e&&e.__esModule?e:{default:e}})(r);t.default=function(e,t,n){return t in e?(0,i.default)(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}}),(function(e,t,n){e.exports={default:n(127),__esModule:!0}}),(function(e,t,n){n(27),n(20),e.exports=n(128)}),(function(e,t,n){var r=n(39),i=n(1)("iterator"),o=n(14);e.exports=n(0).isIterable=function(e){var t=Object(e);return void 0!==t[i]||"@@iterator"in t||o.hasOwnProperty(r(t))}}),(function(e,t,n){e.exports={default:n(130),__esModule:!0}}),(function(e,t,n){n(27),n(20),e.exports=n(131)}),(function(e,t,n){var r=n(5),i=n(40);e.exports=n(0).getIterator=function(e){var t=i(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return r(t.call(e))}}),(function(e,t,n){function r(e){return n(i(e))}function i(e){var t=o[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var o={"./config.dev.json":133,"./config.prod.json":134,"./config.test.json":135};r.keys=function(){return Object.keys(o)},r.resolve=i,e.exports=r,r.id=132}),(function(e,t){e.exports={cognito:{poolId:""},lex:{botName:"WebUiOrderFlowers",initialText:'You can ask me for help ordering flowers. Just type "order flowers" or click on the mic and say it.',initialSpeechInstruction:"Say 'Order Flowers' to get started."},polly:{voiceId:"Salli"},ui:{parentOrigin:"http://localhost:8080",pageTitle:"Order Flowers Bot",toolbarTitle:"Order Flowers"},recorder:{preset:"speech_recognition"}}}),(function(e,t){e.exports={cognito:{poolId:""},lex:{botName:"WebUiOrderFlowers",initialText:'You can ask me for help ordering flowers. Just type "order flowers" or click on the mic and say it.',initialSpeechInstruction:"Say 'Order Flowers' to get started."},polly:{voiceId:"Salli"},ui:{parentOrigin:"",pageTitle:"Order Flowers Bot",toolbarTitle:"Order Flowers"},recorder:{preset:"speech_recognition"}}}),(function(e,t){e.exports={cognito:{poolId:""},lex:{botName:"WebUiOrderFlowers",initialText:'You can ask me for help ordering flowers. Just type "order flowers" or click on the mic and say it.',initialSpeechInstruction:"Say 'Order Flowers' to get started."},polly:{voiceId:"Salli"},ui:{parentOrigin:"http://localhost:8080",pageTitle:"Order Flowers Bot",toolbarTitle:"Order Flowers"},recorder:{preset:"speech_recognition"}}}),(function(e,t,n){"use strict";t.__esModule=!0;var r=n(137),i=(function(e){return e&&e.__esModule?e:{default:e}})(r);t.default=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return(0,i.default)(e)}}),(function(e,t,n){e.exports={default:n(138),__esModule:!0}}),(function(e,t,n){n(20),n(139),e.exports=n(0).Array.from}),(function(e,t,n){"use strict";var r=n(16),i=n(3),o=n(24),s=n(54),a=n(55),u=n(31),c=n(140),l=n(40);i(i.S+i.F*!n(60)((function(e){Array.from(e)})),"Array",{from:function(e){var t,n,i,f,d=o(e),p="function"==typeof this?this:Array,h=arguments.length,g=h>1?arguments[1]:void 0,v=void 0!==g,m=0,b=l(d);if(v&&(g=r(g,h>2?arguments[2]:void 0,2)),void 0==b||p==Array&&a(b))for(t=u(d.length),n=new p(t);t>m;m++)c(n,m,v?g(d[m],m):d[m]);else for(f=b.call(d),n=new p;!(i=f.next()).done;m++)c(n,m,v?s(f,g,[i.value,m],!0):i.value);return n.length=m,n}})}),(function(e,t,n){"use strict";var r=n(4),i=n(17);e.exports=function(e,t,n){t in e?r.f(e,t,i(0,n)):e[t]=n}}),(function(e,t,n){e.exports=function(){return n(142)("/*!\n* lex-web-ui v\"0.14.0\"\n* (c) 2017 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n* Released under the Amazon Software License.\n*/   \n/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"/\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ ((function(module, exports) {\n\n// based on https://github.com/mattdiamond/Recorderjs/blob/master/src/recorder.js\n// with a few optimizations including downsampling and trimming quiet samples\n\n/* global Blob self */\n/* eslint no-restricted-globals: off */\n/* eslint prefer-arrow-callback: [\"error\", { \"allowNamedFunctions\": true }] */\n/* eslint no-param-reassign: [\"error\", { \"props\": false }] */\n/* eslint no-use-before-define: [\"error\", { \"functions\": false }] */\n/* eslint no-plusplus: off */\n/* eslint comma-dangle: [\"error\", {\"functions\": \"never\", \"objects\": \"always-multiline\"}] */\n/* eslint-disable prefer-destructuring */\nconst bitDepth = 16;\nconst bytesPerSample = bitDepth / 8;\nconst outSampleRate = 16000;\nconst outNumChannels = 1;\n\nlet recLength = 0;\nlet recBuffers = [];\n\nconst options = {\n  sampleRate: 44000,\n  numChannels: 1,\n  useDownsample: true,\n  // controls if the encoder will trim silent samples at begining and end of buffer\n  useTrim: true,\n  // trim samples below this value at the beginnig and end of the buffer\n  // lower the value trim less silence (larger file size)\n  // reasonable values seem to be between 0.005 and 0.0005\n  quietTrimThreshold: 0.0008,\n  // how many samples to add back to the buffer before/after the quiet threshold\n  // higher values result in less silence trimming (larger file size)\n  // reasonable values seem to be between 3500 and 5000\n  quietTrimSlackBack: 4000,\n};\n\nself.onmessage = (evt) => {\n  switch (evt.data.command) {\n    case 'init':\n      init(evt.data.config);\n      break;\n    case 'record':\n      record(evt.data.buffer);\n      break;\n    case 'exportWav':\n      exportWAV(evt.data.type);\n      break;\n    case 'getBuffer':\n      getBuffer();\n      break;\n    case 'clear':\n      clear();\n      break;\n    case 'close':\n      self.close();\n      break;\n    default:\n      break;\n  }\n};\n\nfunction init(config) {\n  Object.assign(options, config);\n  initBuffers();\n}\n\nfunction record(inputBuffer) {\n  for (let channel = 0; channel < options.numChannels; channel++) {\n    recBuffers[channel].push(inputBuffer[channel]);\n  }\n  recLength += inputBuffer[0].length;\n}\n\nfunction exportWAV(type) {\n  const buffers = [];\n  for (let channel = 0; channel < options.numChannels; channel++) {\n    buffers.push(mergeBuffers(recBuffers[channel], recLength));\n  }\n  let interleaved;\n  if (options.numChannels === 2 && outNumChannels === 2) {\n    interleaved = interleave(buffers[0], buffers[1]);\n  } else {\n    interleaved = buffers[0];\n  }\n  const downsampledBuffer = downsampleTrimBuffer(interleaved, outSampleRate);\n  const dataview = encodeWAV(downsampledBuffer);\n  const audioBlob = new Blob([dataview], { type });\n\n  self.postMessage({\n    command: 'exportWAV',\n    data: audioBlob,\n  });\n}\n\nfunction getBuffer() {\n  const buffers = [];\n  for (let channel = 0; channel < options.numChannels; channel++) {\n    buffers.push(mergeBuffers(recBuffers[channel], recLength));\n  }\n  self.postMessage({ command: 'getBuffer', data: buffers });\n}\n\nfunction clear() {\n  recLength = 0;\n  recBuffers = [];\n  initBuffers();\n}\n\nfunction initBuffers() {\n  for (let channel = 0; channel < options.numChannels; channel++) {\n    recBuffers[channel] = [];\n  }\n}\n\nfunction mergeBuffers(recBuffer, length) {\n  const result = new Float32Array(length);\n  let offset = 0;\n  for (let i = 0; i < recBuffer.length; i++) {\n    result.set(recBuffer[i], offset);\n    offset += recBuffer[i].length;\n  }\n  return result;\n}\n\nfunction interleave(inputL, inputR) {\n  const length = inputL.length + inputR.length;\n  const result = new Float32Array(length);\n\n  let index = 0;\n  let inputIndex = 0;\n\n  while (index < length) {\n    result[index++] = inputL[inputIndex];\n    result[index++] = inputR[inputIndex];\n    inputIndex++;\n  }\n  return result;\n}\n\nfunction floatTo16BitPCM(output, offset, input) {\n  for (let i = 0, o = offset; i < input.length; i++, o += 2) {\n    const s = Math.max(-1, Math.min(1, input[i]));\n    output.setInt16(o, s < 0 ? s * 0x8000 : s * 0x7FFF, true);\n  }\n}\n\n// Lex doesn't require proper wav header\n// still inserting wav header for playing on client side\nfunction addHeader(view, length) {\n  // RIFF identifier 'RIFF'\n  view.setUint32(0, 1380533830, false);\n  // file length minus RIFF identifier length and file description length\n  view.setUint32(4, 36 + length, true);\n  // RIFF type 'WAVE'\n  view.setUint32(8, 1463899717, false);\n  // format chunk identifier 'fmt '\n  view.setUint32(12, 1718449184, false);\n  // format chunk length\n  view.setUint32(16, 16, true);\n  // sample format (raw)\n  view.setUint16(20, 1, true);\n  // channel count\n  view.setUint16(22, outNumChannels, true);\n  // sample rate\n  view.setUint32(24, outSampleRate, true);\n  // byte rate (sample rate * block align)\n  view.setUint32(28, outSampleRate * bytesPerSample * outNumChannels, true);\n  // block align (channel count * bytes per sample)\n  view.setUint16(32, bytesPerSample * outNumChannels, true);\n  // bits per sample\n  view.setUint16(34, bitDepth, true);\n  // data chunk identifier 'data'\n  view.setUint32(36, 1684108385, false);\n}\n\nfunction encodeWAV(samples) {\n  const buffer = new ArrayBuffer(44 + (samples.length * 2));\n  const view = new DataView(buffer);\n\n  addHeader(view, samples.length);\n  floatTo16BitPCM(view, 44, samples);\n\n  return view;\n}\n\nfunction downsampleTrimBuffer(buffer, rate) {\n  if (rate === options.sampleRate) {\n    return buffer;\n  }\n\n  const length = buffer.length;\n  const sampleRateRatio = options.sampleRate / rate;\n  const newLength = Math.round(length / sampleRateRatio);\n\n  const result = new Float32Array(newLength);\n  let offsetResult = 0;\n  let offsetBuffer = 0;\n  let firstNonQuiet = 0;\n  let lastNonQuiet = length;\n  while (offsetResult < result.length) {\n    const nextOffsetBuffer = Math.round((offsetResult + 1) * sampleRateRatio);\n    let accum = 0;\n    let count = 0;\n    for (let i = offsetBuffer; (i < nextOffsetBuffer) && (i < length); i++) {\n      accum += buffer[i];\n      count++;\n    }\n    // mark first and last sample over the quiet threshold\n    if (accum > options.quietTrimThreshold) {\n      if (firstNonQuiet === 0) {\n        firstNonQuiet = offsetResult;\n      }\n      lastNonQuiet = offsetResult;\n    }\n    result[offsetResult] = accum / count;\n    offsetResult++;\n    offsetBuffer = nextOffsetBuffer;\n  }\n\n  /*\n  console.info('encoder trim size reduction',\n    (Math.min(newLength, lastNonQuiet + options.quietTrimSlackBack) -\n    Math.max(0, firstNonQuiet - options.quietTrimSlackBack)) / result.length\n  );\n  */\n  return (options.useTrim) ?\n    // slice based on quiet threshold and put slack back into the buffer\n    result.slice(\n      Math.max(0, firstNonQuiet - options.quietTrimSlackBack),\n      Math.min(newLength, lastNonQuiet + options.quietTrimSlackBack)\n    ) :\n    result;\n}\n\n\n/***/ }))\n/******/ ]);",n.p+"bundle/wav-worker.min.js")}}),(function(e,t,n){"use strict";var r=window.URL||window.webkitURL;e.exports=function(e,t){try{try{var n;try{var i=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;n=new i,n.append(e),n=n.getBlob()}catch(t){n=new Blob([e])}return new Worker(r.createObjectURL(n))}catch(t){return new Worker("data:application/javascript,"+encodeURIComponent(e))}}catch(e){if(!t)throw Error("Inline worker is not supported");return new Worker(t)}}}),(function(e,t){e.exports="data:audio/ogg;base64,T2dnUwACAAAAAAAAAAAyzN3NAAAAAGFf2X8BM39GTEFDAQAAAWZMYUMAAAAiEgASAAAAAAAkFQrEQPAAAAAAAAAAAAAAAAAAAAAAAAAAAE9nZ1MAAAAAAAAAAAAAMszdzQEAAAD5LKCSATeEAAAzDQAAAExhdmY1NS40OC4xMDABAAAAGgAAAGVuY29kZXI9TGF2YzU1LjY5LjEwMCBmbGFjT2dnUwAEARIAAAAAAAAyzN3NAgAAAKWVljkCDAD/+GkIAAAdAAABICI="}),(function(e,t){e.exports="data:audio/mpeg;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU2LjM2LjEwMAAAAAAAAAAAAAAA//OEAAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAAEAAABIADAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDV1dXV1dXV1dXV1dXV1dXV1dXV1dXV1dXV6urq6urq6urq6urq6urq6urq6urq6urq6v////////////////////////////////8AAAAATGF2YzU2LjQxAAAAAAAAAAAAAAAAJAAAAAAAAAAAASDs90hvAAAAAAAAAAAAAAAAAAAA//MUZAAAAAGkAAAAAAAAA0gAAAAATEFN//MUZAMAAAGkAAAAAAAAA0gAAAAARTMu//MUZAYAAAGkAAAAAAAAA0gAAAAAOTku//MUZAkAAAGkAAAAAAAAA0gAAAAANVVV"})])}));